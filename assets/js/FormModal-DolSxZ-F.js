import{g as e,a}from"./index-DJ5eHNvF.js";import{D as t,r as n,e as r,k as s,m as i,b as l,F as o,j as d,M as c,R as m,C as u,I as p,L as h}from"./index-CNTZKFxL.js";import{R as g}from"./index-BDBYGIyJ.js";import f from"./CategorySelectModal-Cudyj7vo.js";import{T as C}from"./index-BOEfK5ZH.js";import{S}from"./index-fO0Fj89w.js";const y=e=>t.get("/admin-api/v1/plugins/content/content-article",{...e,pageIndex:null==e?void 0:e.current}),v=e=>t.delete("/admin-api/v1/plugins/content/content-article",{ids:e}),w=e=>t.download("/admin-api/v1/plugins/content/content-article/export",e),b=n.forwardRef((({onConfirm:y},v)=>{const[w]=r.useForm(),[b,I]=n.useState(!1),[j,x]=n.useState({}),[F,k]=n.useState(new Map),M=n.useRef(null);n.useImperativeHandle(v,(()=>({showAddFormModal(){E(),I(!0)},async showEditFormModal(e){const{data:a,msg:n,code:r}=await(e=>t.get("/admin-api/v1/plugins/content/content-article/"+e))(e);r===s.SUCCESS?(x(a),w.setFieldsValue(a),I(!0)):i.error(n)}}))),n.useEffect((()=>{(async()=>{const{data:t,msg:n,code:r}=await e("admin_sys_status");r===s.SUCCESS?k(a(t)):i.error(n)})()}),[]);const E=()=>{j.id>0?x({}):x({id:0}),setTimeout((()=>w.resetFields()),100)},_=e=>{w.validateFields().then((async a=>{try{if(j.id<=0){const{msg:e,code:r}=await(n=a,t.post("/admin-api/v1/plugins/content/content-article",n));if(r!==s.SUCCESS)return void i.error(e);i.success(e)}else{const{msg:e,code:n}=await((e,a)=>t.put("/admin-api/v1/plugins/content/content-article/"+e,a))(j.id,a);if(n!==s.SUCCESS)return void i.error(e);i.success(e)}E(),I(!1),y()}finally{e()}var n})).catch((a=>{i.error("表单校验失败"),e()}))};return l(o,{children:[d(c,{title:j.id>0?"编辑":"新增",getContainer:!1,width:800,open:b,maskClosable:!1,keyboard:!1,onCancel:()=>{E(),I(!1)},destroyOnClose:!0,footer:[d(h,{onClick:e=>{E(),I(!1),e()},children:"取消"},"cancel"),d(h,{type:"primary",onClick:e=>_(e),children:"确定"},"confirm")],children:d(r,{form:w,layout:"vertical",initialValues:j,children:l(m,{gutter:24,children:[d(u,{span:12,children:d(r.Item,{name:"cateId",label:"分类编号",rules:[{required:!0,message:"请输入分类编号"}],children:d(C,{style:{width:"100%"},min:0,onClick:()=>{var e;null==(e=M.current)||e.showCategorySelectModal()}})})}),d(u,{span:12,children:d(r.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请输入状态"}],children:d(S,{placeholder:"请选择",children:Array.from(F).map((([e,a])=>d(S.Option,{value:e,children:a},e)))})})}),d(u,{span:24,children:d(r.Item,{name:"name",label:"标题",rules:[{required:!0,message:"请输入标题"}],children:d(p,{placeholder:"请输入标题"})})}),d(u,{span:24,children:d(r.Item,{name:"content",label:"内容",rules:[{required:!0,message:"请输入内容"}],children:d(g,{placeholder:"请输入内容"})})}),d(u,{span:24,children:d(r.Item,{name:"remark",label:"备注信息",rules:[{required:!0,message:"请输入备注信息"}],children:d(p.TextArea,{placeholder:"请输入备注信息"})})})]})})}),d(f,{ref:M,onConfirm:async e=>{x({...j,cateId:e.id}),w.setFieldsValue({cateId:e.id})}})]})})),I=Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"}));export{b as F,I as a,v as d,w as e,y as g};
