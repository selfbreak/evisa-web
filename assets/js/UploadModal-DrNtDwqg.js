import{r as e,b as r,F as a,j as n,B as i,dP as o,M as s,ca as l}from"./index-CiAhniVm.js";import{i as t}from"./index-CeVyQ8_h.js";import{U as c}from"./index-lJVXQZS9.js";import"./progress-i1-phs3_.js";const d=({maxSize:d=5,accept:p="image/*",onSuccess:m})=>{var u;const[g,h]=e.useState(!1),[f,S]=e.useState([]),[y,x]=e.useState(!1);return r(a,{children:[n(i,{type:"primary",onClick:()=>h(!0),icon:n(o,{}),children:"Upload"}),r(s,{title:"Upload Passport",open:g,onCancel:()=>h(!1),footer:[n(i,{onClick:()=>h(!1),children:"Cancel"},"cancel"),n(i,{type:"primary",loading:y,onClick:async()=>{if(f.length){x(!0);try{const e=f[0].originFileObj;await t({file:e,onSuccess:r=>{400==r.code?l.error(`${e.name} 上传失败: ${r.msg}`):(l.success(`${e.name} 上传成功`),S([]),h(!1),null==m||m())},onError:r=>{l.error(`${e.name} 上传失败: ${r.message}`)}})}catch(e){l.error("上传过程发生异常")}finally{x(!1)}}else l.warning("请先选择文件")},disabled:!f.length,children:y?"Uploading...":"Start Upload"},"submit")],children:[r(c,{accept:p,fileList:f,beforeUpload:e=>{const r=p.split(",").some((r=>e.type.match(r.replace("*",".*")))),a=e.size/1024/1024<=d;return r?!a&&(l.error(`文件大小不能超过 ${d}MB`),c.LIST_IGNORE):(l.error(`仅支持 ${p} 格式文件`),c.LIST_IGNORE)},onChange:({fileList:e})=>S(e.slice(-1)),onRemove:()=>S([]),multiple:!1,maxCount:1,children:[n(i,{icon:n(o,{}),children:"Select File"}),n("span",{style:{marginLeft:8},children:"Support drag-and-drop upload"})]}),n("div",{style:{marginTop:16},children:(null==(u=f[0])?void 0:u.name)||"No file selected"})]})]})};export{d as default};
