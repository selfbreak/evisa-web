import{g as e,a as r}from"./index-c4h0cPyU.js";import{a,b as s,u as t}from"./index-C3Tc9qxt.js";import{r as o,e as i,k as l,m as d,j as n,M as m,b as c,I as u,L as h}from"./index-Dn3i6gWy.js";import{T as f}from"./index-2Ycx2kMs.js";import{R as p}from"./index-fNqrUQoI.js";const C=o.forwardRef((({onConfirm:C},S)=>{const[y]=i.useForm(),[g,w]=o.useState(!1),[b,j]=o.useState({}),[x,I]=o.useState(new Map);o.useImperativeHandle(S,(()=>({showAddFormModal(){k(),w(!0)},async showEditFormModal(e){const{data:r,msg:s,code:t}=await a(e);t===l.SUCCESS?(j(r),y.setFieldsValue(r),w(!0)):d.error(s)}}))),o.useEffect((()=>{(async()=>{const{data:a,msg:s,code:t}=await e("admin_sys_status");t===l.SUCCESS?I(r(a)):d.error(s)})()}),[]);const k=()=>{b.id>0?j({}):j({id:0}),setTimeout((()=>y.resetFields()),100)};return n(m,{title:b.id>0?"编辑":"新增",getContainer:!1,width:500,open:g,maskClosable:!1,keyboard:!1,onCancel:()=>{k(),w(!1)},destroyOnClose:!0,footer:[n(h,{onClick:e=>{k(),w(!1),e()},children:"取消"},"cancel"),n(h,{type:"primary",onClick:e=>(e=>{y.validateFields().then((async r=>{try{if(b.id<=0){const{msg:e,code:a}=await s(r);if(a!==l.SUCCESS)return void d.error(e);d.success(e)}else{const{msg:e,code:a}=await t(b.id,r);if(a!==l.SUCCESS)return void d.error(e);d.success(e)}k(),w(!1),C()}finally{e()}})).catch((r=>{d.error("表单校验失败"),e()}))})(e),children:"确定"},"confirm")],children:c(i,{form:y,layout:"vertical",initialValues:b,children:[n(i.Item,{name:"postCode",label:"岗位编码",rules:[{required:!0,message:"请输入岗位编码"}],children:n(u,{placeholder:"请输入岗位编码"})}),n(i.Item,{name:"postName",label:"岗位名称",rules:[{required:!0,message:"请输入岗位名称"}],children:n(u,{placeholder:"请输入岗位名称"})}),n(i.Item,{name:"remark",label:"备注",rules:[{required:!0,message:"请输入备注"}],children:n(u.TextArea,{placeholder:"请输入备注"})}),n(i.Item,{name:"sort",label:"岗位排序",rules:[{required:!0,message:"请输入岗位排序"}],children:n(f,{placeholder:"请输入岗位排序",style:{width:"100%"},min:0})}),n(i.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请输入状态"}],children:n(p.Group,{children:Array.from(x).map((([e,r])=>n(p,{value:e,children:r},e)))})})]})})}));export{C as default};
