import{a as e,i,b as n,d as a,c as t,e as r}from"./index-DiJZ8cjZ.js";import{H as s}from"./index-BKOeEJjd.js";import{u as o,r as l,E as d,b as c,F as m,j as p,L as u,ay as y,S as h,v as f,az as x,w as C,k as j,m as k,aA as g,x as w,y as T}from"./index-CF0uPSqa.js";import{p as S}from"./proTable-BUOzHjgg.js";import{f as b,b as v}from"./index-Ciy2PQr0.js";import I from"./DBTableModal-2QXkGJa8.js";import z from"./PreviewCodeModal-BVKgJWj-.js";import{P as A}from"./Table-B9rVsbjG.js";import"./ProCard-Bue0EHV6.js";import"./useMultipleSelect-99ZlYGY_.js";import"./index-Dt39BrXh.js";import"./iconUtil-BQ9hmHLe.js";import"./List-BxMwUPDj.js";import"./index-CaSRyzTT.js";import"./useShowArrow-JZdoaKQl.js";import"./useIcons-qJD2PldO.js";import"./index-TUxR6zD5.js";import"./index-DYwQrF37.js";import"./index-C42jQXwS.js";import"./Table-gxbh8EuT.js";import"./addEventListener-DmCt_0od.js";import"./index-DiIzqjBn.js";import"./progress-Cy-rdL8d.js";import"./index-DKcBysMr.js";import"./index-BRe-pjag.js";import"./index-B-8gtYmB.js";import"./index-EdbprBVH.js";import"./index-CBqcB6Mk.js";const E=()=>{const E=o(),M=l.useRef(null),R=l.useRef(),N=l.useRef(null),{drop:U}=d.useAliveController(),B=[{title:"序号",dataIndex:"index",valueType:"index",width:80,align:"center",className:"gray-cell",render:(e,i,n,a)=>{var t,r;return(((null==(t=null==a?void 0:a.pageInfo)?void 0:t.current)||1)-1)*((null==(r=null==a?void 0:a.pageInfo)?void 0:r.pageSize)||10)+n+1}},{title:"表编号",dataIndex:"id",width:80,hideInSearch:!0},{title:"数据库表名",dataIndex:"tableName",width:300},{title:"数据库表描述",dataIndex:"tableComment",width:150},{title:"类名",dataIndex:"className",hideInSearch:!0,width:180},{title:"创建时间",key:"createdAt",dataIndex:"createdAt",valueType:"dateTime",hideInSearch:!0,width:180},{title:"创建时间",dataIndex:"createTime",valueType:"dateTimeRange",hideInTable:!0,search:{transform:e=>({beginCreatedAt:e[0],endCreatedAt:e[1]})}},{title:"操作",key:"option",fixed:"right",width:530,hideInSearch:!0,render:(e,i)=>c(h,{children:[p(s,{permission:["admin:sys-gen:edit"],children:p(u,{type:"link",size:"small",icon:p(f,{}),onClick:e=>{O(i.id,e)},children:"编辑"},"edit")}),p(s,{permission:["admin:sys-gen:preview"],children:p(u,{type:"link",size:"small",icon:p(x,{}),onClick:e=>{P(i.id,e)},children:"预览"},"preview")}),p(s,{permission:["admin:sys-gen:gen-code"],children:p(u,{type:"link",size:"small",icon:p(x,{}),onClick:e=>{L(i.id,e)},children:"生成代码"},"genCode")}),p(s,{permission:["admin:sys-gen:download-code"],children:p(u,{type:"link",size:"small",icon:p(x,{}),onClick:e=>{F(i.id,e)},children:"下载代码"},"downCode")}),p(s,{permission:["admin:sys-gen:import-config"],children:p(u,{type:"link",size:"small",icon:p(x,{}),onClick:e=>{D(i.id,e)},children:"配置导入"},"genMenu")}),p(s,{permission:["admin:sys-gen:del"],children:p(u,{type:"link",size:"small",danger:!0,icon:p(C,{}),onClick:e=>K(i.id,e),children:"删除"},"del")})]})}],O=async(e,i)=>{await U(g),E(g,{state:{id:e}}),setTimeout((()=>i()),1e3)},P=async(e,i)=>{var n;null==(n=N.current)||n.showPreviewCodeModal(e),setTimeout((()=>i()),1e3)},L=async(e,i)=>{w.confirm({title:"提示",icon:p(T,{}),content:"是否为编号 "+e+" 生成代码?",okText:"确认",cancelText:"取消",maskClosable:!0,onCancel:()=>{i()},onOk:async()=>{try{const{msg:i,code:a}=await n(e);if(a!==j.SUCCESS)return void k.error(i);k.success(i)}finally{i()}}})},D=async(e,i)=>{w.confirm({title:"提示",icon:p(T,{}),content:"导入完成后，需要重新手动刷新页面。是否为编号 "+e+" 导入菜单到数据库?",okText:"确认",cancelText:"取消",maskClosable:!0,onCancel:()=>{i()},onOk:async()=>{try{const{msg:i,code:n}=await t(e);if(n!==j.SUCCESS)return void k.error(i);k.success(i)}finally{i()}}})},F=async(e,i)=>{w.confirm({title:"提示",icon:p(T,{}),content:"是否确认下载编号为 "+e+" 的代码?",okText:"确认",cancelText:"取消",maskClosable:!0,onCancel:()=>{i()},onOk:async()=>{try{v("code",await a(e))}catch(n){k.error("下载失败，请检查网络")}finally{i()}}})},K=(e,i)=>{w.confirm({title:"提示",icon:p(T,{}),content:"是否确认删除编号为 "+e+" 的数据项?",okText:"确认",cancelText:"取消",maskClosable:!0,onCancel:()=>{i()},onOk:async()=>{var i;try{const{code:n,msg:a}=await r([e]);if(n!==j.SUCCESS)return void k.error(a);null==(i=R.current)||i.reload(!1),k.success(a)}finally{}}})};return c(m,{children:[p(A,{className:"ant-pro-table-scroll",columns:B,actionRef:R,bordered:!0,cardBordered:!0,defaultSize:"small",scroll:{x:"100%",y:"100%"},request:async i=>{const{data:n}=await e(i);return b(n)},columnsState:{persistenceKey:"use-pro-table-key",persistenceType:"localStorage"},options:{reload:!0,density:!0,fullScreen:!0},rowKey:"id",search:{labelWidth:"auto"},pagination:S,dateFormatter:"string",headerTitle:"代码列表",toolBarRender:()=>[p(u,{type:"primary",icon:p(y,{}),onClick:e=>(e=>{var i;null==(i=M.current)||i.showDBTableModal(),setTimeout((()=>e()),1e3)})(e),children:"导入数据库表"},"importTable")]}),p(I,{ref:M,onConfirm:async e=>{var n;let a=[];e.forEach((e=>a.push(e.tableName)));const{msg:t,code:r}=await i(a);r==j.SUCCESS?null==(n=R.current)||n.reload(!1):k.error(t)}}),p(z,{ref:N,onConfirm:()=>{}})]})};export{E as default};
