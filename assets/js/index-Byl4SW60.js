import{g as e,a as t}from"./index-BUaE1SvI.js";import{r as n,a5 as a,a6 as r,a7 as i,b6 as o,W as s,aR as l,aJ as c,aY as d,a$ as p,p as m,j as u,b as f,F as h,dQ as g,L as y,w as x,v as w,S,dR as v,B as k,dS as b,dT as j,dU as C,y as E,dV as I,aW as O,dW as T,x as _,k as $,m as N}from"./index-1r8JWfgz.js";import{H as z}from"./index-D_bIpIMT.js";import{p as M}from"./proTable-BUOzHjgg.js";import{f as R}from"./index-Ciy2PQr0.js";import F from"./FormModal-CWuvDJOj.js";import P from"./UploadModal-Bgw0hj6i.js";import{j as D,k as H}from"./index-DHXvyyiq.js";import U from"./EditFormModal-BTUbzZ9t.js";import{I as B}from"./index-GoKe3Wm1.js";import{P as L}from"./Table-D_xGBklT.js";import"./index-Cm_6869b.js";import"./index-BvkZOgk5.js";import"./index-CdSjPi-L.js";import"./index-B192wQR2.js";import"./progress-BcXvJvrj.js";import"./index-Dq_vpnwv.js";import"./index-B_wfliL_.js";import"./useShowArrow-Daazj4CU.js";import"./List-ChZv07U9.js";import"./useIcons-BHLMDnfs.js";import"./index-W7Cy8U3b.js";import"./addEventListener-BH_BE75u.js";import"./ProCard-CUCtPAt9.js";import"./useMultipleSelect-Co7-OLCE.js";import"./iconUtil-BPC3zoJt.js";import"./index-DiXSzV0z.js";import"./index-BPF-qgPe.js";import"./Table-DwXFwsAN.js";import"./index-cbycQo8g.js";import"./index-reTt9TJs.js";import"./index-DK5hclXs.js";const A=e=>{const{value:t,formatter:a,precision:r,decimalSeparator:i,groupSeparator:o="",prefixCls:s}=e;let l;if("function"==typeof a)l=a(t);else{const e=String(t),a=e.match(/^(-?)(\d*)(\.(\d+))?$/);if(a&&"-"!==e){const e=a[1];let t=a[2]||"0",c=a[4]||"";t=t.replace(/\B(?=(\d{3})+(?!\d))/g,o),"number"==typeof r&&(c=c.padEnd(r,"0").slice(0,r>0?r:0)),c&&(c=`${i}${c}`),l=[n.createElement("span",{key:"int",className:`${s}-content-value-int`},e,t),c&&n.createElement("span",{key:"decimal",className:`${s}-content-value-decimal`},c)]}else l=e}return n.createElement("span",{className:`${s}-content-value`},l)},W=e=>{const{componentCls:t,marginXXS:n,padding:a,colorTextDescription:r,titleFontSize:o,colorTextHeading:s,contentFontSize:l,fontFamily:c}=e;return{[t]:Object.assign(Object.assign({},i(e)),{[`${t}-title`]:{marginBottom:n,color:r,fontSize:o},[`${t}-skeleton`]:{paddingTop:a},[`${t}-content`]:{color:s,fontSize:l,fontFamily:c,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:n},[`${t}-content-suffix`]:{marginInlineStart:n}}})}},X=a("Statistic",(e=>{const t=r(e,{});return[W(t)]}),(e=>{const{fontSizeHeading3:t,fontSize:n}=e;return{titleFontSize:n,contentFontSize:t}}));const K=e=>{const{prefixCls:t,className:a,rootClassName:r,style:i,valueStyle:d,value:p=0,title:m,valueRender:u,prefix:f,suffix:h,loading:g=!1,formatter:y,precision:x,decimalSeparator:w=".",groupSeparator:S=",",onMouseEnter:v,onMouseLeave:k}=e,b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:j,direction:C,className:E,style:I}=o("statistic"),O=j("statistic",t),[T,_,$]=X(O),N=n.createElement(A,{decimalSeparator:w,groupSeparator:S,prefixCls:O,formatter:y,precision:x,value:p}),z=s(O,{[`${O}-rtl`]:"rtl"===C},E,a,r,_,$),M=l(b,{aria:!0,data:!0});return T(n.createElement("div",Object.assign({},M,{className:z,style:Object.assign(Object.assign({},I),i),onMouseEnter:v,onMouseLeave:k}),m&&n.createElement("div",{className:`${O}-title`},m),n.createElement(c,{paragraph:!1,loading:g,className:`${O}-skeleton`},n.createElement("div",{style:d,className:`${O}-content`},f&&n.createElement("span",{className:`${O}-content-prefix`},f),u?u(N):N,h&&n.createElement("span",{className:`${O}-content-suffix`},h)))))},Y=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function q(e,t){const{format:n=""}=t,a=new Date(e).getTime(),r=Date.now();return function(e,t){let n=e;const a=/\[[^\]]*]/g,r=(t.match(a)||[]).map((e=>e.slice(1,-1))),i=t.replace(a,"[]"),o=Y.reduce(((e,t)=>{let[a,r]=t;if(e.includes(a)){const t=Math.floor(n/r);return n-=t*r,e.replace(new RegExp(`${a}+`,"g"),(e=>{const n=e.length;return t.toString().padStart(n,"0")}))}return e}),i);let s=0;return o.replace(a,(()=>{const e=r[s];return s+=1,e}))}(Math.max(a-r,0),n)}const J=1e3/30;const Q=e=>{const{value:t,format:a="HH:mm:ss",onChange:r,onFinish:i}=e,o=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["value","format","onChange","onFinish"]),s=d(),l=n.useRef(null),c=()=>{const e=function(e){return new Date(e).getTime()}(t);e>=Date.now()&&(l.current=setInterval((()=>{s(),null==r||r(e-Date.now()),e<Date.now()&&(null==i||i(),l.current&&(clearInterval(l.current),l.current=null))}),J))};n.useEffect((()=>(c(),()=>{l.current&&(clearInterval(l.current),l.current=null)})),[t]);return n.createElement(K,Object.assign({},o,{value:t,valueRender:e=>p(e,{title:void 0}),formatter:(e,t)=>q(e,Object.assign(Object.assign({},t),{format:a}))}))};K.Countdown=n.memo(Q);const V=()=>{const a=m.useRef(),r=m.useRef(),i=n.useRef(null),o=n.useRef(null),[s,l]=n.useState(new Map),[c,d]=n.useState(new Map),[p,A]=n.useState({}),W=()=>{var e;null==(e=a.current)||e.reload()},X=[{title:"UID",dataIndex:"id",width:80,align:"center"},{title:u(h,{children:g("passport.passportNumber")}),dataIndex:"passport_number",width:150,align:"center",hideInSearch:!0},{title:u(h,{children:g("passport.status")}),dataIndex:"status",valueType:"select",valueEnum:s,width:80,align:"center"},{title:"护照图片",dataIndex:"passport_image",width:150,align:"center",hideInSearch:!0,render:(e,t)=>t.file_path?u(B,{width:40,height:40,src:"https://visa.koko.kg/"+t.file_path,preview:{src:"https://visa.koko.kg/"+t.file_path,toolbarRender:()=>null},style:{objectFit:"cover"}}):u("span",{children:"未上传"})},{title:u(h,{children:g("passport.firstName")}),dataIndex:"first_name",width:100,align:"center"},{title:u(h,{children:g("passport.lastName")}),dataIndex:"last_name",width:100,align:"center"},{title:u(h,{children:g("passport.sex")}),dataIndex:"gender",hideInSearch:!0,width:80,align:"center"},{title:u(h,{children:g("passport.countryRegion")}),dataIndex:"country_code",width:120,align:"center"},{title:u(h,{children:g("passport.dateOfBirth")}),dataIndex:"birth_date",hideInSearch:!0,width:100,align:"center"},{title:u(h,{children:g("passport.dateOfIssue")}),dataIndex:"issue_date",width:120,align:"center"},{title:u(h,{children:g("passport.dateOfExpiration")}),dataIndex:"expiration_date",width:140,align:"center"},{title:u(h,{children:g("passport.createTime")}),dataIndex:"create_at",hideInSearch:!0,valueType:"dateTime",width:180,align:"center"},{title:u(h,{children:g("passport.createTime")}),dataIndex:"createdAt",valueType:"dateTimeRange",hideInTable:!0,search:{transform:e=>({beginCreatedAt:e[0],endCreatedAt:e[1]})}},{title:u(h,{children:g("passport.action")}),valueType:"option",align:"center",width:150,render:(e,t)=>f(z,{permission:["app:passport:apply"],children:[u(y,{type:"link",size:"small",danger:!0,icon:u(x,{}),onClick:e=>((e,t)=>{_.confirm({title:"提示",icon:u(E,{}),content:"是否确认删除编号为 "+e+" 的数据项?",okText:"确认",cancelText:"取消",maskClosable:!0,onCancel:()=>{t()},onOk:async()=>{var n;try{const{code:t,msg:r}=await H(e);if(t!==$.SUCCESS)return void N.error(r);null==(n=a.current)||n.reload(!1),N.success("删除成功")}finally{t()}}})})(t.id,e),children:"删除"},"delete"),u(y,{type:"link",size:"small",icon:u(w,{}),onClick:e=>q(t.id,e),children:"修改"},"external-link"),u(S,{children:"0"===t.status?u(y,{type:"link",size:"small",icon:u(v,{}),onClick:e=>Y(t.id,e),children:"申请"},"edit"):"1"===t.status?u(k,{type:"link",size:"small",icon:u(b,{}),onClick:()=>window.open(t.link,"_blank"),children:"去支付"},"external-link"):"2"===t.status?u(k,{type:"link",size:"small",icon:u(j,{style:{color:"#8c8c8c"}}),onClick:()=>window.open(t.link,"_blank"),style:{color:"#8c8c8c"},children:"审核中"},"external-link-2"):"3"===t.status?u(k,{type:"link",size:"small",danger:!0,icon:u(C,{}),onClick:()=>window.open(t.link,"_blank"),children:"拒签"},"external-link-2"):"4"===t.status?u(k,{type:"link",size:"small",icon:u(E,{style:{color:"#faad14"}}),style:{color:"#faad14"},onClick:()=>window.open(t.link,"_blank"),children:"补充资料"},"external-link-2"):"5"===t.status?f(h,{children:[u(k,{type:"link",size:"small",icon:u(I,{style:{color:"green"}}),style:{color:"green"},onClick:()=>window.open(t.link,"_blank"),children:"申请通过"},"external-link-2"),u(k,{type:"link",size:"small",icon:u(O,{}),onClick:()=>window.open(`/admin-api/v1/app/evisa/download/${t.id}`,"_blank"),children:"下载签证"},"download-link")]}):u("span",{children:"-"})})]})}];n.useEffect((()=>{(async()=>{const{data:n,msg:a,code:r}=await e("app_user_apply_type");if(r!==$.SUCCESS)return void N.error(a);l(t(n));const{data:i,msg:o,code:s}=await e("app_user_apply_type");s===$.SUCCESS?d(t(i)):N.error(o)})()}),[]);const Y=(e,t)=>{var n;null==(n=i.current)||n.showEditFormModal(e),setTimeout((()=>t()),1e3)},q=(e,t)=>{var n;null==(n=o.current)||n.showEditPassPortFormModal(e),setTimeout((()=>t()),1e3)};return f(h,{children:[u(L,{className:"ant-pro-table-scroll",columns:X,actionRef:a,formRef:r,bordered:!0,cardBordered:!0,defaultSize:"small",scroll:{x:"2000",y:"100%"},request:async e=>{const{data:t}=await D(e);return A(t.extend),R(t)},columnsState:{persistenceKey:"use-pro-table-key",persistenceType:"localStorage"},options:{reload:!0,density:!0,fullScreen:!0},rowKey:"id",search:{labelWidth:"auto",showHiddenNum:!0},pagination:M,dateFormatter:"string",headerTitle:u(h,{children:g("passport.passportNumber")}),toolBarRender:()=>[u(z,{permission:["app:passport:upload"],children:u(P,{maxSize:10,accept:"image/png,image/jpeg",onSuccess:W},"addTable")},"addTable")],footer:()=>p&&u(K,{title:"余额 总计",value:p.money,valueStyle:{color:T.base}})}),u(F,{ref:i,onConfirm:()=>{var e;null==(e=a.current)||e.reload(!1)}}),u(U,{ref:o,onConfirm:()=>{var e;null==(e=a.current)||e.reload(!1)}})]})};export{V as default};
