import{D as e,r as a,e as s,k as r,m as i,j as n,M as o,b as d,I as t,L as l}from"./index-CiAhniVm.js";import{g as c,a as m}from"./index-Cc57wi3Z.js";import{S as u}from"./index-BJu6fcxc.js";const f=a=>e.get("/admin-api/v1/admin/sys/sys-config",{...a,pageIndex:null==a?void 0:a.current}),p=a=>e.delete("/admin-api/v1/admin/sys/sys-config",{ids:a}),y=a=>e.download("/admin-api/v1/admin/sys/sys-config/export",a),g=a.forwardRef((({onConfirm:f},p)=>{const[y]=s.useForm(),[g,h]=a.useState(!1),[S,v]=a.useState({}),[C,b]=a.useState(new Map),[w,_]=a.useState(new Map);a.useImperativeHandle(p,(()=>({showAddFormModal(){I(),h(!0)},async showEditFormModal(a){const{data:s,msg:n,code:o}=await(a=>e.get("/admin-api/v1/admin/sys/sys-config/"+a))(a);o===r.SUCCESS?(v(s),y.setFieldsValue(s),h(!0)):i.error(n)}}))),a.useEffect((()=>{(async()=>{const{data:e,msg:a,code:s}=await c("admin_sys_config_type");if(s!==r.SUCCESS)return void i.error(a);b(m(e));const{data:n,msg:o,code:d}=await c("admin_sys_config_is_frontend");d===r.SUCCESS?_(m(n)):i.error(o)})()}),[]);const I=()=>{S.id>0?v({}):v({id:0}),setTimeout((()=>y.resetFields()),100)},F=a=>{y.validateFields().then((async s=>{try{if(S.id<=0){const{msg:a,code:o}=await(n=s,e.post("/admin-api/v1/admin/sys/sys-config",n));if(o!==r.SUCCESS)return void i.error(a);i.success(a)}else{const{msg:a,code:n}=await((a,s)=>e.put("/admin-api/v1/admin/sys/sys-config/"+a,s))(S.id,s);if(n!==r.SUCCESS)return void i.error(a);i.success(a)}I(),h(!1),f()}finally{a()}var n})).catch((e=>{i.error("表单校验失败"),a()}))};return n(o,{title:S.id>0?"编辑":"新增",getContainer:!1,width:500,open:g,maskClosable:!1,keyboard:!1,onCancel:()=>{I(),h(!1)},destroyOnClose:!0,footer:[n(l,{onClick:e=>{I(),h(!1),e()},children:"取消"},"cancel"),n(l,{type:"primary",onClick:e=>F(e),children:"确定"},"confirm")],children:d(s,{form:y,layout:"vertical",initialValues:S,children:[n(s.Item,{name:"configKey",label:"键名",rules:[{required:!0,message:"请输入键名"}],children:n(t,{placeholder:"请输入键名"})}),n(s.Item,{name:"configName",label:"配置名称",rules:[{required:!0,message:"请输入配置名称"}],children:n(t,{placeholder:"请输入配置名称"})}),n(s.Item,{name:"configType",label:"配置类型",rules:[{required:!0,message:"请输入配置类型"}],children:n(u,{placeholder:"请选择",children:Array.from(C).map((([e,a])=>n(u.Option,{value:e,children:a},e)))})}),n(s.Item,{name:"configValue",label:"键值",rules:[{required:!0,message:"请输入键值"}],children:n(t,{placeholder:"请输入键值"})}),n(s.Item,{name:"isFrontend",label:"是否前台展示",rules:[{required:!0,message:"请输入是否前台展示"}],children:n(u,{placeholder:"请选择",children:Array.from(w).map((([e,a])=>n(u.Option,{value:e,children:a},e)))})}),n(s.Item,{name:"remark",label:"备注信息",children:n(t.TextArea,{placeholder:"请输入备注信息"})})]})})})),h=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{g as F,h as a,p as d,y as e,f as g};
