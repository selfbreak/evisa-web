import{a as e,u as a}from"./index-3oY8iPhn.js";import{g as r,a as s}from"./index-DJ5eHNvF.js";import{r as t,e as i,k as o,m as l,j as n,M as d,b as c,I as m,L as p}from"./index-CNTZKFxL.js";import{S as h}from"./index-fO0Fj89w.js";import"./useShowArrow-CyBxHHHt.js";import"./List-DvGEh4-g.js";const u=t.forwardRef((({onConfirm:u},f)=>{const[S]=i.useForm(),[y,C]=t.useState(!1),[b,w]=t.useState({}),[g,j]=t.useState(new Map),[v,I]=t.useState(new Map);t.useImperativeHandle(f,(()=>({async showEditFormModal(a){const{data:r,msg:s,code:t}=await e(a);t===o.SUCCESS?(w(r),S.setFieldsValue(r),C(!0)):l.error(s)}}))),t.useEffect((()=>{(async()=>{const{data:e,msg:a,code:t}=await r("admin_sys_api_method");if(t!==o.SUCCESS)return void l.error(a);j(s(e));const{data:i,msg:n,code:d}=await r("admin_sys_config_type");d===o.SUCCESS?I(s(i)):l.error(n)})()}),[]);const k=()=>{b.id>0?w({}):w({id:0}),setTimeout((()=>S.resetFields()),100)};return n(d,{title:"编辑",getContainer:!1,width:500,open:y,maskClosable:!1,keyboard:!1,onCancel:()=>{k(),C(!1)},destroyOnClose:!0,footer:[n(p,{onClick:e=>{k(),C(!1),e()},children:"取消"},"cancel"),n(p,{type:"primary",onClick:e=>(e=>{S.validateFields().then((async r=>{try{const{msg:e,code:s}=await a(b.id,r);if(s!==o.SUCCESS)return void l.error(e);l.success(e),k(),C(!1),u()}finally{e()}})).catch((a=>{l.error("表单校验失败"),e()}))})(e),children:"确定"},"confirm")],children:c(i,{form:S,layout:"vertical",initialValues:b,children:[n(i.Item,{name:"path",label:"接口地址",children:n(m,{placeholder:"请输入接口地址",disabled:!0})}),n(i.Item,{name:"method",label:"接口请求方法",children:n(h,{placeholder:"请选择",disabled:!0,children:Array.from(g).map((([e,a])=>n(h.Option,{value:e,children:a},e)))})}),n(i.Item,{name:"apiType",label:"接口类型",rules:[{required:!0,message:"请输入接口类型"}],children:n(h,{placeholder:"请选择",children:Array.from(v).map((([e,a])=>n(h.Option,{value:e,children:a},e)))})}),n(i.Item,{name:"description",label:"功能描述",rules:[{required:!0,message:"请输入功能描述"}],children:n(m,{placeholder:"请输入功能描述"})}),n(i.Item,{name:"remark",label:"备注",children:n(m.TextArea,{placeholder:"请输入备注"})})]})})}));export{u as default};
