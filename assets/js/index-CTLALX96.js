import{f as e,T as t,S as n,h as s,c as r,j as a,k as c,l}from"./iconUtil-BT82zX-s.js";import{p as o,ac as i,aZ as d,bm as u,da as f,W as p,_ as y,r as b,cX as m,db as x,dc as h}from"./index-BW2Tv2KI.js";function g(e){const{dropPosition:t,dropLevelOffset:n,prefixCls:s,indent:r,direction:a="ltr"}=e,c="ltr"===a?"left":"right",l="ltr"===a?"right":"left",i={[c]:-n*r+4,[l]:0};switch(t){case-1:i.top=-3;break;case 1:i.bottom=-3;break;default:i.bottom=-3,i[c]=r+4}return o.createElement("div",{style:i,className:`${s}-drop-indicator`})}const K=o.forwardRef(((s,r)=>{var a;const{getPrefixCls:c,direction:l,virtual:y,tree:b}=o.useContext(i),{prefixCls:m,className:x,showIcon:h=!1,showLine:K,switcherIcon:v,switcherLoadingIcon:E,blockNode:O=!1,children:w,checkable:j=!1,selectable:N=!0,draggable:k,motion:I,style:C}=s,S=c("tree",m),P=c(),$=null!=I?I:Object.assign(Object.assign({},d(P)),{motionAppear:!1}),A=Object.assign(Object.assign({},s),{checkable:j,selectable:N,showIcon:h,motion:$,blockNode:O,showLine:Boolean(K),dropIndicatorRender:g}),[L,D,R]=e(S),[,T]=u(),H=T.paddingXS/2+((null===(a=T.Tree)||void 0===a?void 0:a.titleHeight)||T.controlHeightSM),M=o.useMemo((()=>{if(!k)return!1;let e={};switch(typeof k){case"function":e.nodeDraggable=k;break;case"object":e=Object.assign({},k)}return!1!==e.icon&&(e.icon=e.icon||o.createElement(f,null)),e}),[k]);return L(o.createElement(t,Object.assign({itemHeight:H,ref:r,virtual:y},A,{style:Object.assign(Object.assign({},null==b?void 0:b.style),C),prefixCls:S,className:p({[`${S}-icon-hide`]:!h,[`${S}-block-node`]:O,[`${S}-unselectable`]:!N,[`${S}-rtl`]:"rtl"===l},null==b?void 0:b.className,x,D,R),direction:l,checkable:j?o.createElement("span",{className:`${S}-checkbox-inner`}):j,selectable:N,switcherIcon:e=>o.createElement(n,{prefixCls:S,switcherIcon:v,switcherLoadingIcon:E,treeNodeProps:e,showLine:K}),draggable:M}),w))}));function v(e,t,n){const{key:s,children:r}=n;e.forEach((function(e){const a=e[s],c=e[r];!1!==t(a,e)&&v(c||[],t,n)}))}function E(e){let{treeData:t,expandedKeys:n,startKey:r,endKey:a,fieldNames:c}=e;const l=[];let o=0;if(r&&r===a)return[r];if(!r||!a)return[];return v(t,(e=>{if(2===o)return!1;if(function(e){return e===r||e===a}(e)){if(l.push(e),0===o)o=1;else if(1===o)return o=2,!1}else 1===o&&l.push(e);return n.includes(e)}),s(c)),l}function O(e,t,n){const r=y(t),a=[];return v(e,((e,t)=>{const n=r.indexOf(e);return-1!==n&&(a.push(t),r.splice(n,1)),!!r.length}),s(n)),a}var w=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};function j(e){const{isLeaf:t,expanded:n}=e;return t?b.createElement(m,null):n?b.createElement(x,null):b.createElement(h,null)}function N(e){let{treeData:t,children:n}=e;return t||c(n)}const k=(e,t)=>{var{defaultExpandAll:n,defaultExpandParent:s,defaultExpandedKeys:c}=e,l=w(e,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const o=b.useRef(null),d=b.useRef(null),[u,f]=b.useState(l.selectedKeys||l.defaultSelectedKeys||[]),[m,x]=b.useState((()=>(()=>{const{keyEntities:e}=r(N(l));let t;return t=n?Object.keys(e):s?a(l.expandedKeys||c||[],e):l.expandedKeys||c||[],t})()));b.useEffect((()=>{"selectedKeys"in l&&f(l.selectedKeys)}),[l.selectedKeys]),b.useEffect((()=>{"expandedKeys"in l&&x(l.expandedKeys)}),[l.expandedKeys]);const{getPrefixCls:h,direction:g}=b.useContext(i),{prefixCls:v,className:k,showIcon:I=!0,expandAction:C="click"}=l,S=w(l,["prefixCls","className","showIcon","expandAction"]),P=h("tree",v),$=p(`${P}-directory`,{[`${P}-directory-rtl`]:"rtl"===g},k);return b.createElement(K,Object.assign({icon:j,ref:t,blockNode:!0},S,{showIcon:I,expandAction:C,prefixCls:P,className:$,expandedKeys:m,selectedKeys:u,onSelect:(e,t)=>{var n;const{multiple:s,fieldNames:r}=l,{node:a,nativeEvent:c}=t,{key:i=""}=a,u=N(l),p=Object.assign(Object.assign({},t),{selected:!0}),b=(null==c?void 0:c.ctrlKey)||(null==c?void 0:c.metaKey),x=null==c?void 0:c.shiftKey;let h;s&&b?(h=e,o.current=i,d.current=h,p.selectedNodes=O(u,h,r)):s&&x?(h=Array.from(new Set([].concat(y(d.current||[]),y(E({treeData:u,expandedKeys:m,startKey:i,endKey:o.current,fieldNames:r}))))),p.selectedNodes=O(u,h,r)):(h=[i],o.current=i,d.current=h,p.selectedNodes=O(u,h,r)),null===(n=l.onSelect)||void 0===n||n.call(l,h,p),"selectedKeys"in l||f(h)},onExpand:(e,t)=>{var n;return"expandedKeys"in l||x(e),null===(n=l.onExpand)||void 0===n?void 0:n.call(l,e,t)}}))},I=b.forwardRef(k),C=K;C.DirectoryTree=I,C.TreeNode=l;export{C as T};
