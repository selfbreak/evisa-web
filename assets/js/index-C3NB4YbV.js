import{g as e,a as t}from"./index-51GUPII2.js";import{r as n,a5 as a,a6 as r,a7 as i,b6 as s,W as o,aR as l,aJ as c,aY as d,a$ as p,p as m,j as u,b as f,F as h,dQ as g,L as y,w as x,v as S,S as v,dR as j,B as w,dS as b,dT as k,dU as C,y as E,dV as I,dW as O,x as T,k as _,m as $}from"./index-Cb-OfYTB.js";import{H as N}from"./index-DGPAKYhn.js";import{p as z}from"./proTable-BUOzHjgg.js";import{f as M}from"./index-Ciy2PQr0.js";import R from"./FormModal-BZMQOnU_.js";import F from"./UploadModal-D3Ha6n8s.js";import{j as P,k as D}from"./index-B2V_l0x6.js";import H from"./EditFormModal-DDq9UsYK.js";import{I as U}from"./index-BCjpOIej.js";import{P as B}from"./Table-BxsDek8o.js";import"./index-E7fW6Wc4.js";import"./index-CpO9Um5A.js";import"./index-eA0FKpYf.js";import"./index-D9uH9n3R.js";import"./progress-pFp7SqXr.js";import"./index-Cb_7Qg68.js";import"./index-BLPgdlfF.js";import"./useShowArrow-kPaoQtLn.js";import"./List-CQS8542Y.js";import"./useIcons-B9G3Xjv5.js";import"./index-BYkxeQZ9.js";import"./addEventListener-C6eD-up5.js";import"./ProCard-CqvPz3AX.js";import"./useMultipleSelect-2VOAT-bl.js";import"./iconUtil-BvOebmd6.js";import"./index-BPhC5TFe.js";import"./index-DQsJGzPa.js";import"./Table-Dd4pgmTM.js";import"./index-DWvtmrHT.js";import"./index-DdIGKavJ.js";import"./index--DjAoKkS.js";const L=e=>{const{value:t,formatter:a,precision:r,decimalSeparator:i,groupSeparator:s="",prefixCls:o}=e;let l;if("function"==typeof a)l=a(t);else{const e=String(t),a=e.match(/^(-?)(\d*)(\.(\d+))?$/);if(a&&"-"!==e){const e=a[1];let t=a[2]||"0",c=a[4]||"";t=t.replace(/\B(?=(\d{3})+(?!\d))/g,s),"number"==typeof r&&(c=c.padEnd(r,"0").slice(0,r>0?r:0)),c&&(c=`${i}${c}`),l=[n.createElement("span",{key:"int",className:`${o}-content-value-int`},e,t),c&&n.createElement("span",{key:"decimal",className:`${o}-content-value-decimal`},c)]}else l=e}return n.createElement("span",{className:`${o}-content-value`},l)},A=e=>{const{componentCls:t,marginXXS:n,padding:a,colorTextDescription:r,titleFontSize:s,colorTextHeading:o,contentFontSize:l,fontFamily:c}=e;return{[t]:Object.assign(Object.assign({},i(e)),{[`${t}-title`]:{marginBottom:n,color:r,fontSize:s},[`${t}-skeleton`]:{paddingTop:a},[`${t}-content`]:{color:o,fontSize:l,fontFamily:c,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:n},[`${t}-content-suffix`]:{marginInlineStart:n}}})}},W=a("Statistic",(e=>{const t=r(e,{});return[A(t)]}),(e=>{const{fontSizeHeading3:t,fontSize:n}=e;return{titleFontSize:n,contentFontSize:t}}));const X=e=>{const{prefixCls:t,className:a,rootClassName:r,style:i,valueStyle:d,value:p=0,title:m,valueRender:u,prefix:f,suffix:h,loading:g=!1,formatter:y,precision:x,decimalSeparator:S=".",groupSeparator:v=",",onMouseEnter:j,onMouseLeave:w}=e,b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["prefixCls","className","rootClassName","style","valueStyle","value","title","valueRender","prefix","suffix","loading","formatter","precision","decimalSeparator","groupSeparator","onMouseEnter","onMouseLeave"]),{getPrefixCls:k,direction:C,className:E,style:I}=s("statistic"),O=k("statistic",t),[T,_,$]=W(O),N=n.createElement(L,{decimalSeparator:S,groupSeparator:v,prefixCls:O,formatter:y,precision:x,value:p}),z=o(O,{[`${O}-rtl`]:"rtl"===C},E,a,r,_,$),M=l(b,{aria:!0,data:!0});return T(n.createElement("div",Object.assign({},M,{className:z,style:Object.assign(Object.assign({},I),i),onMouseEnter:j,onMouseLeave:w}),m&&n.createElement("div",{className:`${O}-title`},m),n.createElement(c,{paragraph:!1,loading:g,className:`${O}-skeleton`},n.createElement("div",{style:d,className:`${O}-content`},f&&n.createElement("span",{className:`${O}-content-prefix`},f),u?u(N):N,h&&n.createElement("span",{className:`${O}-content-suffix`},h)))))},K=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function Y(e,t){const{format:n=""}=t,a=new Date(e).getTime(),r=Date.now();return function(e,t){let n=e;const a=/\[[^\]]*]/g,r=(t.match(a)||[]).map((e=>e.slice(1,-1))),i=t.replace(a,"[]"),s=K.reduce(((e,t)=>{let[a,r]=t;if(e.includes(a)){const t=Math.floor(n/r);return n-=t*r,e.replace(new RegExp(`${a}+`,"g"),(e=>{const n=e.length;return t.toString().padStart(n,"0")}))}return e}),i);let o=0;return s.replace(a,(()=>{const e=r[o];return o+=1,e}))}(Math.max(a-r,0),n)}const q=1e3/30;const J=e=>{const{value:t,format:a="HH:mm:ss",onChange:r,onFinish:i}=e,s=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n}(e,["value","format","onChange","onFinish"]),o=d(),l=n.useRef(null),c=()=>{const e=function(e){return new Date(e).getTime()}(t);e>=Date.now()&&(l.current=setInterval((()=>{o(),null==r||r(e-Date.now()),e<Date.now()&&(null==i||i(),l.current&&(clearInterval(l.current),l.current=null))}),q))};n.useEffect((()=>(c(),()=>{l.current&&(clearInterval(l.current),l.current=null)})),[t]);return n.createElement(X,Object.assign({},s,{value:t,valueRender:e=>p(e,{title:void 0}),formatter:(e,t)=>Y(e,Object.assign(Object.assign({},t),{format:a}))}))};X.Countdown=n.memo(J);const Q=()=>{const a=m.useRef(),r=m.useRef(),i=n.useRef(null),s=n.useRef(null),[o,l]=n.useState(new Map),[c,d]=n.useState(new Map),[p,L]=n.useState({}),A=()=>{var e;null==(e=a.current)||e.reload()},W=[{title:"UID",dataIndex:"id",width:80,align:"center"},{title:u(h,{children:g("passport.passportNumber")}),dataIndex:"passport_number",width:150,align:"center",hideInSearch:!0},{title:u(h,{children:g("passport.status")}),dataIndex:"status",valueType:"select",valueEnum:o,width:80,align:"center"},{title:"护照图片",dataIndex:"passport_image",width:150,align:"center",hideInSearch:!0,render:(e,t)=>t.file_path?u(U,{width:40,height:40,src:"https://visa.koko.kg/"+t.file_path,preview:{src:"https://visa.koko.kg/"+t.file_path,toolbarRender:()=>null},style:{objectFit:"cover"}}):u("span",{children:"未上传"})},{title:u(h,{children:g("passport.firstName")}),dataIndex:"first_name",width:100,align:"center"},{title:u(h,{children:g("passport.lastName")}),dataIndex:"last_name",width:100,align:"center"},{title:u(h,{children:g("passport.sex")}),dataIndex:"gender",hideInSearch:!0,width:80,align:"center"},{title:u(h,{children:g("passport.countryRegion")}),dataIndex:"country_code",width:120,align:"center"},{title:u(h,{children:g("passport.dateOfBirth")}),dataIndex:"birth_date",hideInSearch:!0,width:100,align:"center"},{title:u(h,{children:g("passport.dateOfIssue")}),dataIndex:"issue_date",width:120,align:"center"},{title:u(h,{children:g("passport.dateOfExpiration")}),dataIndex:"expiration_date",width:140,align:"center"},{title:u(h,{children:g("passport.createTime")}),dataIndex:"create_at",hideInSearch:!0,valueType:"dateTime",width:180,align:"center"},{title:u(h,{children:g("passport.createTime")}),dataIndex:"createdAt",valueType:"dateTimeRange",hideInTable:!0,search:{transform:e=>({beginCreatedAt:e[0],endCreatedAt:e[1]})}},{title:u(h,{children:g("passport.action")}),valueType:"option",align:"center",width:150,render:(e,t)=>f(N,{permission:["app:passport:apply"],children:[u(y,{type:"link",size:"small",danger:!0,icon:u(x,{}),onClick:e=>((e,t)=>{T.confirm({title:"提示",icon:u(E,{}),content:"是否确认删除编号为 "+e+" 的数据项?",okText:"确认",cancelText:"取消",maskClosable:!0,onCancel:()=>{t()},onOk:async()=>{var n;try{const{code:t,msg:r}=await D(e);if(t!==_.SUCCESS)return void $.error(r);null==(n=a.current)||n.reload(!1),$.success("删除成功")}finally{t()}}})})(t.id,e),children:"删除"},"delete"),u(y,{type:"link",size:"small",icon:u(S,{}),onClick:e=>Y(t.id,e),children:"修改"},"external-link"),u(v,{children:"0"===t.status?u(y,{type:"link",size:"small",icon:u(j,{}),onClick:e=>K(t.id,e),children:"申请"},"edit"):"1"===t.status?u(w,{type:"link",size:"small",icon:u(b,{}),onClick:()=>window.open(t.link,"_blank"),children:"去支付"},"external-link"):"2"===t.status?u(w,{type:"link",size:"small",icon:u(k,{style:{color:"#8c8c8c"}}),onClick:()=>window.open(t.link,"_blank"),style:{color:"#8c8c8c"},children:"审核中"},"external-link-2"):"3"===t.status?u(w,{type:"link",size:"small",danger:!0,icon:u(C,{}),onClick:()=>window.open(t.link,"_blank"),children:"拒签"},"external-link-2"):"4"===t.status?u(w,{type:"link",size:"small",icon:u(E,{style:{color:"#faad14"}}),style:{color:"#faad14"},onClick:()=>window.open(t.link,"_blank"),children:"补充资料"},"external-link-2"):"5"===t.status?u(w,{type:"link",size:"small",icon:u(I,{style:{color:"green"}}),style:{color:"green"},onClick:()=>window.open(t.link,"_blank"),children:"申请通过"},"external-link-2"):u("span",{children:"-"})})]})}];n.useEffect((()=>{(async()=>{const{data:n,msg:a,code:r}=await e("app_user_apply_type");if(r!==_.SUCCESS)return void $.error(a);l(t(n));const{data:i,msg:s,code:o}=await e("app_user_apply_type");o===_.SUCCESS?d(t(i)):$.error(s)})()}),[]);const K=(e,t)=>{var n;null==(n=i.current)||n.showEditFormModal(e),setTimeout((()=>t()),1e3)},Y=(e,t)=>{var n;null==(n=s.current)||n.showEditPassPortFormModal(e),setTimeout((()=>t()),1e3)};return f(h,{children:[u(B,{className:"ant-pro-table-scroll",columns:W,actionRef:a,formRef:r,bordered:!0,cardBordered:!0,defaultSize:"small",scroll:{x:"2000",y:"100%"},request:async e=>{const{data:t}=await P(e);return L(t.extend),M(t)},columnsState:{persistenceKey:"use-pro-table-key",persistenceType:"localStorage"},options:{reload:!0,density:!0,fullScreen:!0},rowKey:"id",search:{labelWidth:"auto",showHiddenNum:!0},pagination:z,dateFormatter:"string",headerTitle:u(h,{children:g("passport.passportNumber")}),toolBarRender:()=>[u(N,{permission:["app:passport:upload"],children:u(F,{maxSize:10,accept:"image/png,image/jpeg",onSuccess:A},"addTable")},"addTable")],footer:()=>p&&u(X,{title:"余额 总计",value:p.money,valueStyle:{color:O.base}})}),u(R,{ref:i,onConfirm:()=>{var e;null==(e=a.current)||e.reload(!1)}}),u(H,{ref:s,onConfirm:()=>{var e;null==(e=a.current)||e.reload(!1)}})]})};export{Q as default};
