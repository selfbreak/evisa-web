import{f as e,T as t,S as n,h as s,c as r,j as l,k as a,l as c}from"./iconUtil--IrZyQfQ.js";import{p as o,ac as i,aZ as d,bm as u,d5 as f,W as p,_ as y,r as b,cS as m,d6 as x,d7 as h}from"./index-CiAhniVm.js";function g(e){const{dropPosition:t,dropLevelOffset:n,prefixCls:s,indent:r,direction:l="ltr"}=e,a="ltr"===l?"left":"right",c="ltr"===l?"right":"left",i={[a]:-n*r+4,[c]:0};switch(t){case-1:i.top=-3;break;case 1:i.bottom=-3;break;default:i.bottom=-3,i[a]=r+4}return o.createElement("div",{style:i,className:`${s}-drop-indicator`})}const K=o.forwardRef(((s,r)=>{var l;const{getPrefixCls:a,direction:c,virtual:y,tree:b}=o.useContext(i),{prefixCls:m,className:x,showIcon:h=!1,showLine:K,switcherIcon:v,switcherLoadingIcon:E,blockNode:O=!1,children:w,checkable:j=!1,selectable:N=!0,draggable:k,motion:I,style:S}=s,C=a("tree",m),P=a(),$=null!=I?I:Object.assign(Object.assign({},d(P)),{motionAppear:!1}),A=Object.assign(Object.assign({},s),{checkable:j,selectable:N,showIcon:h,motion:$,blockNode:O,showLine:Boolean(K),dropIndicatorRender:g}),[L,D,R]=e(C),[,T]=u(),H=T.paddingXS/2+((null===(l=T.Tree)||void 0===l?void 0:l.titleHeight)||T.controlHeightSM),M=o.useMemo((()=>{if(!k)return!1;let e={};switch(typeof k){case"function":e.nodeDraggable=k;break;case"object":e=Object.assign({},k)}return!1!==e.icon&&(e.icon=e.icon||o.createElement(f,null)),e}),[k]);return L(o.createElement(t,Object.assign({itemHeight:H,ref:r,virtual:y},A,{style:Object.assign(Object.assign({},null==b?void 0:b.style),S),prefixCls:C,className:p({[`${C}-icon-hide`]:!h,[`${C}-block-node`]:O,[`${C}-unselectable`]:!N,[`${C}-rtl`]:"rtl"===c},null==b?void 0:b.className,x,D,R),direction:c,checkable:j?o.createElement("span",{className:`${C}-checkbox-inner`}):j,selectable:N,switcherIcon:e=>o.createElement(n,{prefixCls:C,switcherIcon:v,switcherLoadingIcon:E,treeNodeProps:e,showLine:K}),draggable:M}),w))}));function v(e,t,n){const{key:s,children:r}=n;e.forEach((function(e){const l=e[s],a=e[r];!1!==t(l,e)&&v(a||[],t,n)}))}function E(e){let{treeData:t,expandedKeys:n,startKey:r,endKey:l,fieldNames:a}=e;const c=[];let o=0;if(r&&r===l)return[r];if(!r||!l)return[];return v(t,(e=>{if(2===o)return!1;if(function(e){return e===r||e===l}(e)){if(c.push(e),0===o)o=1;else if(1===o)return o=2,!1}else 1===o&&c.push(e);return n.includes(e)}),s(a)),c}function O(e,t,n){const r=y(t),l=[];return v(e,((e,t)=>{const n=r.indexOf(e);return-1!==n&&(l.push(t),r.splice(n,1)),!!r.length}),s(n)),l}var w=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(n[s[r]]=e[s[r]])}return n};function j(e){const{isLeaf:t,expanded:n}=e;return t?b.createElement(m,null):n?b.createElement(x,null):b.createElement(h,null)}function N(e){let{treeData:t,children:n}=e;return t||a(n)}const k=(e,t)=>{var{defaultExpandAll:n,defaultExpandParent:s,defaultExpandedKeys:a}=e,c=w(e,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const o=b.useRef(null),d=b.useRef(null),[u,f]=b.useState(c.selectedKeys||c.defaultSelectedKeys||[]),[m,x]=b.useState((()=>(()=>{const{keyEntities:e}=r(N(c));let t;return t=n?Object.keys(e):s?l(c.expandedKeys||a||[],e):c.expandedKeys||a||[],t})()));b.useEffect((()=>{"selectedKeys"in c&&f(c.selectedKeys)}),[c.selectedKeys]),b.useEffect((()=>{"expandedKeys"in c&&x(c.expandedKeys)}),[c.expandedKeys]);const{getPrefixCls:h,direction:g}=b.useContext(i),{prefixCls:v,className:k,showIcon:I=!0,expandAction:S="click"}=c,C=w(c,["prefixCls","className","showIcon","expandAction"]),P=h("tree",v),$=p(`${P}-directory`,{[`${P}-directory-rtl`]:"rtl"===g},k);return b.createElement(K,Object.assign({icon:j,ref:t,blockNode:!0},C,{showIcon:I,expandAction:S,prefixCls:P,className:$,expandedKeys:m,selectedKeys:u,onSelect:(e,t)=>{var n;const{multiple:s,fieldNames:r}=c,{node:l,nativeEvent:a}=t,{key:i=""}=l,u=N(c),p=Object.assign(Object.assign({},t),{selected:!0}),b=(null==a?void 0:a.ctrlKey)||(null==a?void 0:a.metaKey),x=null==a?void 0:a.shiftKey;let h;s&&b?(h=e,o.current=i,d.current=h,p.selectedNodes=O(u,h,r)):s&&x?(h=Array.from(new Set([].concat(y(d.current||[]),y(E({treeData:u,expandedKeys:m,startKey:i,endKey:o.current,fieldNames:r}))))),p.selectedNodes=O(u,h,r)):(h=[i],o.current=i,d.current=h,p.selectedNodes=O(u,h,r)),null===(n=c.onSelect)||void 0===n||n.call(c,h,p),"selectedKeys"in c||f(h)},onExpand:(e,t)=>{var n;return"expandedKeys"in c||x(e),null===(n=c.onExpand)||void 0===n?void 0:n.call(c,e,t)}}))},I=b.forwardRef(k),S=K;S.DirectoryTree=I,S.TreeNode=c;export{S as T};
