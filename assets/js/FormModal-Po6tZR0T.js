import{g as e,a}from"./index-CQE5lpZv.js";import{g as r,a as s,u as i}from"./index-BO6zT360.js";import{r as o,e as t,k as l,m as d,j as n,M as m,b as c,I as u,L as p}from"./index-Dl8Lxdud.js";import{S as h}from"./index-DVKSBzjl.js";import"./useShowArrow-CGKvogCn.js";import"./List-Dh0j4bcQ.js";import"./useIcons-DaiRReqd.js";const f=o.forwardRef((({onConfirm:f},S)=>{const[y]=t.useForm(),[C,w]=o.useState(!1),[g,j]=o.useState({}),[b,v]=o.useState(new Map);o.useImperativeHandle(S,(()=>({showAddFormModal(){F(),w(!0)},async showEditFormModal(e){const{data:a,msg:s,code:i}=await r(e);i===l.SUCCESS?(j(a),y.setFieldsValue(a),w(!0)):d.error(s)}}))),o.useEffect((()=>{(async()=>{const{data:r,msg:s,code:i}=await e("app_user_email_type");i===l.SUCCESS?v(a(r)):d.error(s)})()}),[]);const F=()=>{g.id>0?j({}):j({id:0}),setTimeout((()=>y.resetFields()),100)};return n(m,{title:g.id>0?"编辑":"新增",getContainer:!1,width:500,open:C,maskClosable:!1,keyboard:!1,onCancel:()=>{F(),w(!1)},destroyOnClose:!0,footer:[n(p,{onClick:e=>{F(),w(!1),e()},children:"取消"},"cancel"),n(p,{type:"primary",onClick:e=>(e=>{y.validateFields().then((async a=>{try{if(g.id<=0){const{msg:e,code:r}=await s(a);if(r!==l.SUCCESS)return void d.error(e);d.success(e)}else{const{msg:e,code:r}=await i(g.id,a);if(r!==l.SUCCESS)return void d.error(e);d.success(e)}F(),w(!1),f()}finally{e()}})).catch((a=>{d.error("表单校验失败"),e()}))})(e),children:"确定"},"confirm")],children:c(t,{form:y,layout:"vertical",initialValues:g,children:[n(t.Item,{name:"email",label:"邮箱地址",rules:[{required:!0,message:"请输入邮箱地址"}],children:n(u,{placeholder:"请输入请输入邮箱地址"})}),n(t.Item,{name:"email_type",label:"邮箱类型",rules:[{required:!0,message:"请输入邮箱类型"}],children:n(h,{placeholder:"请选择",children:Array.from(b).map((([e,a])=>n(h.Option,{value:e,children:a},e)))})}),n(t.Item,{name:"auth_code",label:"授权码",rules:[{required:!0,message:"请输入授权码"}],children:n(u,{style:{width:"100%"},min:0})})]})})}));f.displayName="FormModal";export{f as default};
