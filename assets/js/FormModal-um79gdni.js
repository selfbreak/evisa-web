import{g as e,a as n}from"./index-Cc57wi3Z.js";import{D as a,r as t,e as r,k as s,m as o,j as i,M as l,b as d,I as c,L as m}from"./index-CiAhniVm.js";import{R as u}from"./index-BlIpG2d2.js";import{T as p}from"./index-BHOlpetE.js";import{S as g}from"./index-BJu6fcxc.js";const f=e=>a.get("/admin-api/v1/plugins/content/content-announcement",{...e,pageIndex:null==e?void 0:e.current}),h=e=>a.delete("/admin-api/v1/plugins/content/content-announcement",{ids:e}),S=e=>a.download("/admin-api/v1/plugins/content/content-announcement/export",e),y=t.forwardRef((({onConfirm:f},h)=>{const[S]=r.useForm(),[y,v]=t.useState(!1),[C,b]=t.useState({}),[w,x]=t.useState(new Map);t.useImperativeHandle(h,(()=>({showAddFormModal(){j(),v(!0)},async showEditFormModal(e){const{data:n,msg:t,code:r}=await(e=>a.get("/admin-api/v1/plugins/content/content-announcement/"+e))(e);r===s.SUCCESS?(b(n),S.setFieldsValue(n),v(!0)):o.error(t)}}))),t.useEffect((()=>{(async()=>{const{data:a,msg:t,code:r}=await e("admin_sys_status");r===s.SUCCESS?x(n(a)):o.error(t)})()}),[]);const j=()=>{C.id>0?b({}):b({id:0}),setTimeout((()=>S.resetFields()),100)},I=e=>{S.validateFields().then((async n=>{try{if(C.id<=0){const{msg:e,code:r}=await(t=n,a.post("/admin-api/v1/plugins/content/content-announcement",t));if(r!==s.SUCCESS)return void o.error(e);o.success(e)}else{const{msg:e,code:t}=await((e,n)=>a.put("/admin-api/v1/plugins/content/content-announcement/"+e,n))(C.id,n);if(t!==s.SUCCESS)return void o.error(e);o.success(e)}j(),v(!1),f()}finally{e()}var t})).catch((n=>{o.error("表单校验失败"),e()}))};return i(l,{title:C.id>0?"编辑":"新增",getContainer:!1,width:800,open:y,maskClosable:!1,keyboard:!1,onCancel:()=>{j(),v(!1)},destroyOnClose:!0,footer:[i(m,{onClick:e=>{j(),v(!1),e()},children:"取消"},"cancel"),i(m,{type:"primary",onClick:e=>I(e),children:"确定"},"confirm")],children:d(r,{form:S,layout:"vertical",initialValues:C,children:[i(r.Item,{name:"title",label:"标题",rules:[{required:!0,message:"请输入标题"}],children:i(c,{placeholder:"请输入标题"})}),i(r.Item,{name:"content",label:"内容",rules:[{required:!0,message:"请输入内容"}],children:i(u,{placeholder:"请输入内容"})}),i(r.Item,{name:"num",label:"阅读次数",rules:[{required:!0,message:"请输入阅读次数"}],children:i(p,{style:{width:"100%"},min:0})}),i(r.Item,{name:"remark",label:"备注信息",rules:[{required:!0,message:"请输入备注信息"}],children:i(c.TextArea,{placeholder:"请输入备注信息"})}),i(r.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请输入状态"}],children:i(g,{placeholder:"请选择",children:Array.from(w).map((([e,n])=>i(g.Option,{value:e,children:n},e)))})})]})})})),v=Object.freeze(Object.defineProperty({__proto__:null,default:y},Symbol.toStringTag,{value:"Module"}));export{y as F,v as a,h as d,S as e,f as g};
