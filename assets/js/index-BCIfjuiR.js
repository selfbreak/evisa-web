import{aK as e,av as t,aw as n,_ as r,aL as o,aM as i,aN as a,at as l,aO as s,aP as c,aQ as u,aq as d,W as p,b as m,r as f,ao as h,aR as g,j as b,a8 as v,aG as w,aa as y,aS as $,aT as x,aU as k,a5 as E,a6 as S,aV as C,a7 as O,w as I,aW as j,az as R,ac as D,G as P,aX as N,aY as F,a0 as U,aZ as A,a_ as L,a$ as T,B as q,b0 as z,b1 as M,b2 as X,b3 as _,b4 as H,U as B,X as W,Y as G,b5 as V}from"./index-CNTZKFxL.js";import{P as K}from"./progress-swhTCgEb.js";const J=function(t,n){if(t&&n){var r=Array.isArray(n)?n:n.split(","),o=t.name||"",i=t.type||"",a=i.replace(/\/.*$/,"");return r.some((function(t){var n=t.trim();if(/^\*(\/\*)?$/.test(t))return!0;if("."===n.charAt(0)){var r=o.toLowerCase(),l=n.toLowerCase(),s=[l];return".jpg"!==l&&".jpeg"!==l||(s=[".jpg",".jpeg"]),s.some((function(e){return r.endsWith(e)}))}return/\/\*$/.test(n)?a===n.replace(/\/.*$/,""):i===n||!!/^\w+$/.test(n)&&(e(!1,"Upload takes an invalidate 'accept' type '".concat(n,"'.Skip for check.")),!0)}))}return!0};function Y(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(n){return t}}function Q(e){var t=new XMLHttpRequest;e.onProgress&&t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var n=new FormData;e.data&&Object.keys(e.data).forEach((function(t){var r=e.data[t];Array.isArray(r)?r.forEach((function(e){n.append("".concat(t,"[]"),e)})):n.append(t,r)})),e.file instanceof Blob?n.append(e.filename,e.file,e.file.name):n.append(e.filename,e.file),t.onerror=function(t){e.onError(t)},t.onload=function(){return t.status<200||t.status>=300?e.onError(function(e,t){var n="cannot ".concat(e.method," ").concat(e.action," ").concat(t.status,"'"),r=new Error(n);return r.status=t.status,r.method=e.method,r.url=e.action,r}(e,t),Y(t)):e.onSuccess(Y(t),t)},t.open(e.method,e.action,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var r=e.headers||{};return null!==r["X-Requested-With"]&&t.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(r).forEach((function(e){null!==r[e]&&t.setRequestHeader(e,r[e])})),t.send(n),{abort:function(){t.abort()}}}var Z=function(){var e=t(n().mark((function e(o,i){var a,l,s,c,u,d,p,m;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d=function(){return(d=t(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.file((function(n){i(n)?(t.fullPath&&!n.webkitRelativePath&&(Object.defineProperties(n,{webkitRelativePath:{writable:!0}}),n.webkitRelativePath=t.fullPath.replace(/^\//,""),Object.defineProperties(n,{webkitRelativePath:{writable:!1}})),e(n)):e(null)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},u=function(e){return d.apply(this,arguments)},c=function(){return(c=t(n().mark((function e(t){var r,o,i,a,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.createReader(),o=[];case 2:return e.next=5,new Promise((function(e){r.readEntries(e,(function(){return e([])}))}));case 5:if(i=e.sent,a=i.length){e.next=9;break}return e.abrupt("break",12);case 9:for(l=0;l<a;l++)o.push(i[l]);e.next=2;break;case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)},s=function(e){return c.apply(this,arguments)},a=[],l=[],o.forEach((function(e){return l.push(e.webkitGetAsEntry())})),p=function(){var e=t(n().mark((function e(t,o){var i,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(t.path=o||"",!t.isFile){e.next=10;break}return e.next=6,u(t);case 6:(i=e.sent)&&a.push(i),e.next=15;break;case 10:if(!t.isDirectory){e.next=15;break}return e.next=13,s(t);case 13:c=e.sent,l.push.apply(l,r(c));case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=0;case 9:if(!(m<l.length)){e.next=15;break}return e.next=12,p(l[m]);case 12:m++,e.next=9;break;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ee=+new Date,te=0;function ne(){return"rc-upload-".concat(ee,"-").concat(++te)}var re=["component","prefixCls","className","classNames","disabled","id","name","style","styles","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave","hasControlInside"],oe=function(e){o(v,e);var b=i(v);function v(){var e;a(this,v);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return e=b.call.apply(b,[this].concat(i)),l(s(e),"state",{uid:ne()}),l(s(e),"reqs",{}),l(s(e),"fileInput",void 0),l(s(e),"_isMounted",void 0),l(s(e),"onChange",(function(t){var n=e.props,o=n.accept,i=n.directory,a=t.target.files,l=r(a).filter((function(e){return!i||J(e,o)}));e.uploadFiles(l),e.reset()})),l(s(e),"onClick",(function(t){var n=e.fileInput;if(n){var r=t.target,o=e.props.onClick;if(r&&"BUTTON"===r.tagName)n.parentNode.focus(),r.blur();n.click(),o&&o(t)}})),l(s(e),"onKeyDown",(function(t){"Enter"===t.key&&e.onClick(t)})),l(s(e),"onFileDrop",function(){var o=t(n().mark((function t(o){var i,a,l;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.props.multiple,o.preventDefault(),"dragover"!==o.type){t.next=4;break}return t.abrupt("return");case 4:if(!e.props.directory){t.next=11;break}return t.next=7,Z(Array.prototype.slice.call(o.dataTransfer.items),(function(t){return J(t,e.props.accept)}));case 7:a=t.sent,e.uploadFiles(a),t.next=14;break;case 11:l=r(o.dataTransfer.files).filter((function(t){return J(t,e.props.accept)})),!1===i&&(l=l.slice(0,1)),e.uploadFiles(l);case 14:case"end":return t.stop()}}),t)})));return function(e){return o.apply(this,arguments)}}()),l(s(e),"uploadFiles",(function(t){var n=r(t),o=n.map((function(t){return t.uid=ne(),e.processFile(t,n)}));Promise.all(o).then((function(t){var n=e.props.onBatchStart;null==n||n(t.map((function(e){return{file:e.origin,parsedFile:e.parsedFile}}))),t.filter((function(e){return null!==e.parsedFile})).forEach((function(t){e.post(t)}))}))})),l(s(e),"processFile",function(){var r=t(n().mark((function t(r,o){var i,a,l,s,u,d,p,m,f;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.props.beforeUpload,a=r,!i){t.next=14;break}return t.prev=3,t.next=6,i(r,o);case 6:a=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),a=!1;case 12:if(!1!==a){t.next=14;break}return t.abrupt("return",{origin:r,parsedFile:null,action:null,data:null});case 14:if("function"!=typeof(l=e.props.action)){t.next=21;break}return t.next=18,l(r);case 18:s=t.sent,t.next=22;break;case 21:s=l;case 22:if("function"!=typeof(u=e.props.data)){t.next=29;break}return t.next=26,u(r);case 26:d=t.sent,t.next=30;break;case 29:d=u;case 30:return p="object"!==c(a)&&"string"!=typeof a||!a?r:a,m=p instanceof File?p:new File([p],r.name,{type:r.type}),(f=m).uid=r.uid,t.abrupt("return",{origin:r,data:d,parsedFile:f,action:s});case 35:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e,t){return r.apply(this,arguments)}}()),l(s(e),"saveFileInput",(function(t){e.fileInput=t})),e}return u(v,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(e){var t=this,n=e.data,r=e.origin,o=e.action,i=e.parsedFile;if(this._isMounted){var a=this.props,l=a.onStart,s=a.customRequest,c=a.name,u=a.headers,d=a.withCredentials,p=a.method,m=r.uid,f=s||Q,h={action:o,filename:c,data:n,file:i,headers:u,withCredentials:d,method:p||"post",onProgress:function(e){var n=t.props.onProgress;null==n||n(e,i)},onSuccess:function(e,n){var r=t.props.onSuccess;null==r||r(e,i,n),delete t.reqs[m]},onError:function(e,n){var r=t.props.onError;null==r||r(e,n,i),delete t.reqs[m]}};l(r),this.reqs[m]=f(h)}}},{key:"reset",value:function(){this.setState({uid:ne()})}},{key:"abort",value:function(e){var t=this.reqs;if(e){var n=e.uid?e.uid:e;t[n]&&t[n].abort&&t[n].abort(),delete t[n]}else Object.keys(t).forEach((function(e){t[e]&&t[e].abort&&t[e].abort(),delete t[e]}))}},{key:"render",value:function(){var e=this.props,t=e.component,n=e.prefixCls,r=e.className,o=e.classNames,i=void 0===o?{}:o,a=e.disabled,s=e.id,c=e.name,u=e.style,b=e.styles,v=void 0===b?{}:b,w=e.multiple,y=e.accept,$=e.capture,x=e.children,k=e.directory,E=e.openFileDialogOnClick,S=e.onMouseEnter,C=e.onMouseLeave,O=e.hasControlInside,I=d(e,re),j=p(l(l(l({},n,!0),"".concat(n,"-disabled"),a),r,r)),R=k?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},D=a?{}:{onClick:E?this.onClick:function(){},onKeyDown:E?this.onKeyDown:function(){},onMouseEnter:S,onMouseLeave:C,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:O?void 0:"0"};return m(t,{...D,className:j,role:O?void 0:"button",style:u,children:[f.createElement("input",{...g(I,{aria:!0,data:!0}),id:s,name:c,disabled:a,type:"file",ref:this.saveFileInput,onClick:function(e){return e.stopPropagation()},key:this.state.uid,style:h({display:"none"},v.input),className:i.input,accept:y,...R,multiple:w,onChange:this.onChange,...null!=$?{capture:$}:{}}),x]})}}]),v}(f.Component);function ie(){}var ae=function(e){o(n,e);var t=i(n);function n(){var e;a(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),l(s(e),"uploader",void 0),l(s(e),"saveUploader",(function(t){e.uploader=t})),e}return u(n,[{key:"abort",value:function(e){this.uploader.abort(e)}},{key:"render",value:function(){return b(oe,{...this.props,ref:this.saveUploader})}}]),n}(f.Component);l(ae,"defaultProps",{component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:ie,onError:ie,onSuccess:ie,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0,hasControlInside:!1});const le=e=>{const{componentCls:t,iconCls:n}=e;return{[`${t}-wrapper`]:{[`${t}-drag`]:{position:"relative",width:"100%",height:"100%",textAlign:"center",background:e.colorFillAlter,border:`${v(e.lineWidth)} dashed ${e.colorBorder}`,borderRadius:e.borderRadiusLG,cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,[t]:{padding:e.padding},[`${t}-btn`]:{display:"table",width:"100%",height:"100%",outline:"none",borderRadius:e.borderRadiusLG,"&:focus-visible":{outline:`${v(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`}},[`${t}-drag-container`]:{display:"table-cell",verticalAlign:"middle"},[`\n          &:not(${t}-disabled):hover,\n          &-hover:not(${t}-disabled)\n        `]:{borderColor:e.colorPrimaryHover},[`p${t}-drag-icon`]:{marginBottom:e.margin,[n]:{color:e.colorPrimary,fontSize:e.uploadThumbnailSize}},[`p${t}-text`]:{margin:`0 0 ${v(e.marginXXS)}`,color:e.colorTextHeading,fontSize:e.fontSizeLG},[`p${t}-hint`]:{color:e.colorTextDescription,fontSize:e.fontSize},[`&${t}-disabled`]:{[`p${t}-drag-icon ${n},\n            p${t}-text,\n            p${t}-hint\n          `]:{color:e.colorTextDisabled}}}}}},se=e=>{const{componentCls:t,iconCls:n,fontSize:r,lineHeight:o,calc:i}=e,a=`${t}-list-item`,l=`${a}-actions`,s=`${a}-action`;return{[`${t}-wrapper`]:{[`${t}-list`]:Object.assign(Object.assign({},w()),{lineHeight:e.lineHeight,[a]:{position:"relative",height:i(e.lineHeight).mul(r).equal(),marginTop:e.marginXS,fontSize:r,display:"flex",alignItems:"center",transition:`background-color ${e.motionDurationSlow}`,borderRadius:e.borderRadiusSM,"&:hover":{backgroundColor:e.controlItemBgHover},[`${a}-name`]:Object.assign(Object.assign({},y),{padding:`0 ${v(e.paddingXS)}`,lineHeight:o,flex:"auto",transition:`all ${e.motionDurationSlow}`}),[l]:{whiteSpace:"nowrap",[s]:{opacity:0},[n]:{color:e.actionsColor,transition:`all ${e.motionDurationSlow}`},[`\n              ${s}:focus-visible,\n              &.picture ${s}\n            `]:{opacity:1}},[`${t}-icon ${n}`]:{color:e.colorTextDescription,fontSize:r},[`${a}-progress`]:{position:"absolute",bottom:e.calc(e.uploadProgressOffset).mul(-1).equal(),width:"100%",paddingInlineStart:i(r).add(e.paddingXS).equal(),fontSize:r,lineHeight:0,pointerEvents:"none","> div":{margin:0}}},[`${a}:hover ${s}`]:{opacity:1},[`${a}-error`]:{color:e.colorError,[`${a}-name, ${t}-icon ${n}`]:{color:e.colorError},[l]:{[`${n}, ${n}:hover`]:{color:e.colorError},[s]:{opacity:1}}},[`${t}-list-item-container`]:{transition:`opacity ${e.motionDurationSlow}, height ${e.motionDurationSlow}`,"&::before":{display:"table",width:0,height:0,content:'""'}}})}}},ce=e=>{const{componentCls:t}=e,n=new $("uploadAnimateInlineIn",{from:{width:0,height:0,padding:0,opacity:0,margin:e.calc(e.marginXS).div(-2).equal()}}),r=new $("uploadAnimateInlineOut",{to:{width:0,height:0,padding:0,opacity:0,margin:e.calc(e.marginXS).div(-2).equal()}}),o=`${t}-animate-inline`;return[{[`${t}-wrapper`]:{[`${o}-appear, ${o}-enter, ${o}-leave`]:{animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseInOutCirc,animationFillMode:"forwards"},[`${o}-appear, ${o}-enter`]:{animationName:n},[`${o}-leave`]:{animationName:r}}},{[`${t}-wrapper`]:x(e)},n,r]},ue=e=>{const{componentCls:t,iconCls:n,uploadThumbnailSize:r,uploadProgressOffset:o,calc:i}=e,a=`${t}-list`,l=`${a}-item`;return{[`${t}-wrapper`]:{[`\n        ${a}${a}-picture,\n        ${a}${a}-picture-card,\n        ${a}${a}-picture-circle\n      `]:{[l]:{position:"relative",height:i(r).add(i(e.lineWidth).mul(2)).add(i(e.paddingXS).mul(2)).equal(),padding:e.paddingXS,border:`${v(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusLG,"&:hover":{background:"transparent"},[`${l}-thumbnail`]:Object.assign(Object.assign({},y),{width:r,height:r,lineHeight:v(i(r).add(e.paddingSM).equal()),textAlign:"center",flex:"none",[n]:{fontSize:e.fontSizeHeading2,color:e.colorPrimary},img:{display:"block",width:"100%",height:"100%",overflow:"hidden"}}),[`${l}-progress`]:{bottom:o,width:`calc(100% - ${v(i(e.paddingSM).mul(2).equal())})`,marginTop:0,paddingInlineStart:i(r).add(e.paddingXS).equal()}},[`${l}-error`]:{borderColor:e.colorError,[`${l}-thumbnail ${n}`]:{[`svg path[fill='${k[0]}']`]:{fill:e.colorErrorBg},[`svg path[fill='${k.primary}']`]:{fill:e.colorError}}},[`${l}-uploading`]:{borderStyle:"dashed",[`${l}-name`]:{marginBottom:o}}},[`${a}${a}-picture-circle ${l}`]:{[`&, &::before, ${l}-thumbnail`]:{borderRadius:"50%"}}}}},de=e=>{const{componentCls:t,iconCls:n,fontSizeLG:r,colorTextLightSolid:o,calc:i}=e,a=`${t}-list`,l=`${a}-item`,s=e.uploadPicCardSize;return{[`\n      ${t}-wrapper${t}-picture-card-wrapper,\n      ${t}-wrapper${t}-picture-circle-wrapper\n    `]:Object.assign(Object.assign({},w()),{display:"block",[`${t}${t}-select`]:{width:s,height:s,textAlign:"center",verticalAlign:"top",backgroundColor:e.colorFillAlter,border:`${v(e.lineWidth)} dashed ${e.colorBorder}`,borderRadius:e.borderRadiusLG,cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,[`> ${t}`]:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",textAlign:"center"},[`&:not(${t}-disabled):hover`]:{borderColor:e.colorPrimary}},[`${a}${a}-picture-card, ${a}${a}-picture-circle`]:{display:"flex",flexWrap:"wrap","@supports not (gap: 1px)":{"& > *":{marginBlockEnd:e.marginXS,marginInlineEnd:e.marginXS}},"@supports (gap: 1px)":{gap:e.marginXS},[`${a}-item-container`]:{display:"inline-block",width:s,height:s,verticalAlign:"top"},"&::after":{display:"none"},"&::before":{display:"none"},[l]:{height:"100%",margin:0,"&::before":{position:"absolute",zIndex:1,width:`calc(100% - ${v(i(e.paddingXS).mul(2).equal())})`,height:`calc(100% - ${v(i(e.paddingXS).mul(2).equal())})`,backgroundColor:e.colorBgMask,opacity:0,transition:`all ${e.motionDurationSlow}`,content:'" "'}},[`${l}:hover`]:{[`&::before, ${l}-actions`]:{opacity:1}},[`${l}-actions`]:{position:"absolute",insetInlineStart:0,zIndex:10,width:"100%",whiteSpace:"nowrap",textAlign:"center",opacity:0,transition:`all ${e.motionDurationSlow}`,[`\n            ${n}-eye,\n            ${n}-download,\n            ${n}-delete\n          `]:{zIndex:10,width:r,margin:`0 ${v(e.marginXXS)}`,fontSize:r,cursor:"pointer",transition:`all ${e.motionDurationSlow}`,color:o,"&:hover":{color:o},svg:{verticalAlign:"baseline"}}},[`${l}-thumbnail, ${l}-thumbnail img`]:{position:"static",display:"block",width:"100%",height:"100%",objectFit:"contain"},[`${l}-name`]:{display:"none",textAlign:"center"},[`${l}-file + ${l}-name`]:{position:"absolute",bottom:e.margin,display:"block",width:`calc(100% - ${v(i(e.paddingXS).mul(2).equal())})`},[`${l}-uploading`]:{[`&${l}`]:{backgroundColor:e.colorFillAlter},[`&::before, ${n}-eye, ${n}-download, ${n}-delete`]:{display:"none"}},[`${l}-progress`]:{bottom:e.marginXL,width:`calc(100% - ${v(i(e.paddingXS).mul(2).equal())})`,paddingInlineStart:0}}}),[`${t}-wrapper${t}-picture-circle-wrapper`]:{[`${t}${t}-select`]:{borderRadius:"50%"}}}},pe=e=>{const{componentCls:t}=e;return{[`${t}-rtl`]:{direction:"rtl"}}},me=e=>{const{componentCls:t,colorTextDisabled:n}=e;return{[`${t}-wrapper`]:Object.assign(Object.assign({},O(e)),{[t]:{outline:0,"input[type='file']":{cursor:"pointer"}},[`${t}-select`]:{display:"inline-block"},[`${t}-hidden`]:{display:"none"},[`${t}-disabled`]:{color:n,cursor:"not-allowed"}})}},fe=E("Upload",(e=>{const{fontSizeHeading3:t,fontHeight:n,lineWidth:r,controlHeightLG:o,calc:i}=e,a=S(e,{uploadThumbnailSize:i(t).mul(2).equal(),uploadProgressOffset:i(i(n).div(2)).add(r).equal(),uploadPicCardSize:i(o).mul(2.55).equal()});return[me(a),le(a),ue(a),de(a),se(a),ce(a),pe(a),C(a)]}),(e=>({actionsColor:e.colorTextDescription})));function he(e){return Object.assign(Object.assign({},e),{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.name,size:e.size,type:e.type,uid:e.uid,percent:0,originFileObj:e})}function ge(e,t){const n=r(t),o=n.findIndex((t=>{let{uid:n}=t;return n===e.uid}));return-1===o?n.push(e):n[o]=e,n}function be(e,t){const n=void 0!==e.uid?"uid":"name";return t.filter((t=>t[n]===e[n]))[0]}const ve=e=>0===e.indexOf("image/"),we=e=>{if(e.type&&!e.thumbUrl)return ve(e.type);const t=e.thumbUrl||e.url||"",n=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("/"),t=e[e.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(t)||[""])[0]}(t);return!(!/^data:image\//.test(t)&&!/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(n))||!/^data:/.test(t)&&!n},ye=200;function $e(e){return new Promise((t=>{if(!e.type||!ve(e.type))return void t("");const n=document.createElement("canvas");n.width=ye,n.height=ye,n.style.cssText="position: fixed; left: 0; top: 0; width: 200px; height: 200px; z-index: 9999; display: none;",document.body.appendChild(n);const r=n.getContext("2d"),o=new Image;if(o.onload=()=>{const{width:e,height:i}=o;let a=ye,l=ye,s=0,c=0;e>i?(l=i*(ye/e),c=-(l-a)/2):(a=e*(ye/i),s=-(a-l)/2),r.drawImage(o,s,c,a,l);const u=n.toDataURL();document.body.removeChild(n),window.URL.revokeObjectURL(o.src),t(u)},o.crossOrigin="anonymous",e.type.startsWith("image/svg+xml")){const t=new FileReader;t.onload=()=>{t.result&&"string"==typeof t.result&&(o.src=t.result)},t.readAsDataURL(e)}else if(e.type.startsWith("image/gif")){const n=new FileReader;n.onload=()=>{n.result&&t(n.result)},n.readAsDataURL(e)}else o.src=window.URL.createObjectURL(e)}))}const xe=f.forwardRef(((e,t)=>{let{prefixCls:n,className:r,style:o,locale:i,listType:a,file:l,items:s,progress:c,iconRender:u,actionIconRender:d,itemRender:m,isImgUrl:h,showPreviewIcon:g,showRemoveIcon:b,showDownloadIcon:v,previewIcon:w,removeIcon:y,downloadIcon:$,extra:x,onPreview:k,onDownload:E,onClose:S}=e;var C,O;const{status:F}=l,[U,A]=f.useState(F);f.useEffect((()=>{"removed"!==F&&A(F)}),[F]);const[L,T]=f.useState(!1);f.useEffect((()=>{const e=setTimeout((()=>{T(!0)}),300);return()=>{clearTimeout(e)}}),[]);const q=u(l);let z=f.createElement("div",{className:`${n}-icon`},q);if("picture"===a||"picture-card"===a||"picture-circle"===a)if("uploading"===U||!l.thumbUrl&&!l.url){const e=p(`${n}-list-item-thumbnail`,{[`${n}-list-item-file`]:"uploading"!==U});z=f.createElement("div",{className:e},q)}else{const e=(null==h?void 0:h(l))?f.createElement("img",{src:l.thumbUrl||l.url,alt:l.name,className:`${n}-list-item-image`,crossOrigin:l.crossOrigin}):q,t=p(`${n}-list-item-thumbnail`,{[`${n}-list-item-file`]:h&&!h(l)});z=f.createElement("a",{className:t,onClick:e=>k(l,e),href:l.url||l.thumbUrl,target:"_blank",rel:"noopener noreferrer"},e)}const M=p(`${n}-list-item`,`${n}-list-item-${U}`),X="string"==typeof l.linkProps?JSON.parse(l.linkProps):l.linkProps,_=("function"==typeof b?b(l):b)?d(("function"==typeof y?y(l):y)||f.createElement(I,null),(()=>S(l)),n,i.removeFile,!0):null,H=("function"==typeof v?v(l):v)&&"done"===U?d(("function"==typeof $?$(l):$)||f.createElement(j,null),(()=>E(l)),n,i.downloadFile):null,B="picture-card"!==a&&"picture-circle"!==a&&f.createElement("span",{key:"download-delete",className:p(`${n}-list-item-actions`,{picture:"picture"===a})},H,_),W="function"==typeof x?x(l):x,G=W&&f.createElement("span",{className:`${n}-list-item-extra`},W),V=p(`${n}-list-item-name`),J=l.url?f.createElement("a",Object.assign({key:"view",target:"_blank",rel:"noopener noreferrer",className:V,title:l.name},X,{href:l.url,onClick:e=>k(l,e)}),l.name,G):f.createElement("span",{key:"view",className:V,onClick:e=>k(l,e),title:l.name},l.name,G),Y=("function"==typeof g?g(l):g)&&(l.url||l.thumbUrl)?f.createElement("a",{href:l.url||l.thumbUrl,target:"_blank",rel:"noopener noreferrer",onClick:e=>k(l,e),title:i.previewFile},"function"==typeof w?w(l):w||f.createElement(R,null)):null,Q=("picture-card"===a||"picture-circle"===a)&&"uploading"!==U&&f.createElement("span",{className:`${n}-list-item-actions`},Y,"done"===U&&H,_),{getPrefixCls:Z}=f.useContext(D),ee=Z(),te=f.createElement("div",{className:M},z,J,B,Q,L&&f.createElement(N,{motionName:`${ee}-fade`,visible:"uploading"===U,motionDeadline:2e3},(e=>{let{className:t}=e;const r="percent"in l?f.createElement(K,Object.assign({},c,{type:"line",percent:l.percent,"aria-label":l["aria-label"],"aria-labelledby":l["aria-labelledby"]})):null;return f.createElement("div",{className:p(`${n}-list-item-progress`,t)},r)}))),ne=l.response&&"string"==typeof l.response?l.response:(null===(C=l.error)||void 0===C?void 0:C.statusText)||(null===(O=l.error)||void 0===O?void 0:O.message)||i.uploadError,re="error"===U?f.createElement(P,{title:ne,getPopupContainer:e=>e.parentNode},te):te;return f.createElement("div",{className:p(`${n}-list-item-container`,r),style:o,ref:t},m?m(re,l,s,{download:E.bind(null,l),preview:k.bind(null,l),remove:S.bind(null,l)}):re)})),ke=(e,t)=>{const{listType:n="text",previewFile:o=$e,onPreview:i,onDownload:a,onRemove:l,locale:s,iconRender:c,isImageUrl:u=we,prefixCls:d,items:m=[],showPreviewIcon:h=!0,showRemoveIcon:g=!0,showDownloadIcon:b=!1,removeIcon:v,previewIcon:w,downloadIcon:y,extra:$,progress:x={size:[-1,2],showInfo:!1},appendAction:k,appendActionVisible:E=!0,itemRender:S,disabled:C}=e,O=F(),[I,j]=f.useState(!1),R=["picture-card","picture-circle"].includes(n);f.useEffect((()=>{n.startsWith("picture")&&(m||[]).forEach((e=>{(e.originFileObj instanceof File||e.originFileObj instanceof Blob)&&void 0===e.thumbUrl&&(e.thumbUrl="",null==o||o(e.originFileObj).then((t=>{e.thumbUrl=t||"",O()})))}))}),[n,m,o]),f.useEffect((()=>{j(!0)}),[]);const P=(e,t)=>{if(i)return null==t||t.preventDefault(),i(e)},H=e=>{"function"==typeof a?a(e):e.url&&window.open(e.url)},B=e=>{null==l||l(e)},W=e=>{if(c)return c(e,n);const t="uploading"===e.status;if(n.startsWith("picture")){const r="picture"===n?f.createElement(z,null):s.uploading,o=(null==u?void 0:u(e))?f.createElement(M,null):f.createElement(X,null);return t?r:o}return t?f.createElement(z,null):f.createElement(_,null)},G=(e,t,n,r,o)=>{const i={type:"text",size:"small",title:r,onClick:n=>{var r,o;t(),f.isValidElement(e)&&(null===(o=(r=e.props).onClick)||void 0===o||o.call(r,n))},className:`${n}-list-item-action`};return o&&(i.disabled=C),f.isValidElement(e)?f.createElement(q,Object.assign({},i,{icon:T(e,Object.assign(Object.assign({},e.props),{onClick:()=>{}}))})):f.createElement(q,Object.assign({},i),f.createElement("span",null,e))};f.useImperativeHandle(t,(()=>({handlePreview:P,handleDownload:H})));const{getPrefixCls:V}=f.useContext(D),K=V("upload",d),J=V(),Y=p(`${K}-list`,`${K}-list-${n}`),Q=f.useMemo((()=>U(A(J),["onAppearEnd","onEnterEnd","onLeaveEnd"])),[J]),Z=Object.assign(Object.assign({},R?{}:Q),{motionDeadline:2e3,motionName:`${K}-${R?"animate-inline":"animate"}`,keys:r(m.map((e=>({key:e.uid,file:e})))),motionAppear:I});return f.createElement("div",{className:Y},f.createElement(L,Object.assign({},Z,{component:!1}),(e=>{let{key:t,file:r,className:o,style:i}=e;return f.createElement(xe,{key:t,locale:s,prefixCls:K,className:o,style:i,file:r,items:m,progress:x,listType:n,isImgUrl:u,showPreviewIcon:h,showRemoveIcon:g,showDownloadIcon:b,removeIcon:v,previewIcon:w,downloadIcon:y,extra:$,iconRender:W,actionIconRender:G,itemRender:S,onPreview:P,onDownload:H,onClose:B})})),k&&f.createElement(N,Object.assign({},Z,{visible:E,forceRender:!0}),(e=>{let{className:t,style:n}=e;return T(k,(e=>({className:p(e.className,t),style:Object.assign(Object.assign(Object.assign({},n),{pointerEvents:t?"none":void 0}),e.style)})))})))},Ee=f.forwardRef(ke);var Se=function(e,t,n,r){return new(n||(n=Promise))((function(t,o){function i(e){try{l(r.next(e))}catch(t){o(t)}}function a(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,a)}l((r=r.apply(e,[])).next())}))};const Ce=`__LIST_IGNORE_${Date.now()}__`,Oe=(e,t)=>{const{fileList:n,defaultFileList:o,onRemove:i,showUploadList:a=!0,listType:l="text",onPreview:s,onDownload:c,onChange:u,onDrop:d,previewFile:m,disabled:h,locale:g,iconRender:b,isImageUrl:v,progress:w,prefixCls:y,className:$,type:x="select",children:k,style:E,itemRender:S,maxCount:C,data:O={},multiple:I=!1,hasControlInside:j=!0,action:R="",accept:P="",supportServerRender:N=!0,rootClassName:F}=e,U=f.useContext(H),A=null!=h?h:U,[L,T]=B(o||[],{value:n,postState:e=>null!=e?e:[]}),[q,z]=f.useState("drop"),M=f.useRef(null),X=f.useRef(null);f.useMemo((()=>{const e=Date.now();(n||[]).forEach(((t,n)=>{t.uid||Object.isFrozen(t)||(t.uid=`__AUTO__${e}_${n}__`)}))}),[n]);const _=(e,t,n)=>{let o=r(t),i=!1;1===C?o=o.slice(-1):C&&(i=o.length>C,o=o.slice(0,C)),V.flushSync((()=>{T(o)}));const a={file:e,fileList:o};n&&(a.event=n),i&&"removed"!==e.status&&!o.some((t=>t.uid===e.uid))||V.flushSync((()=>{null==u||u(a)}))},K=e=>{const t=e.filter((e=>!e.file[Ce]));if(!t.length)return;const n=t.map((e=>he(e.file)));let o=r(L);n.forEach((e=>{o=ge(e,o)})),n.forEach(((e,n)=>{let r=e;if(t[n].parsedFile)e.status="uploading";else{const{originFileObj:t}=e;let n;try{n=new File([t],t.name,{type:t.type})}catch(i){n=new Blob([t],{type:t.type}),n.name=t.name,n.lastModifiedDate=new Date,n.lastModified=(new Date).getTime()}n.uid=e.uid,r=n}_(r,o)}))},J=(e,t,n)=>{try{"string"==typeof e&&(e=JSON.parse(e))}catch(i){}if(!be(t,L))return;const r=he(t);r.status="done",r.percent=100,r.response=e,r.xhr=n;const o=ge(r,L);_(r,o)},Y=(e,t)=>{if(!be(t,L))return;const n=he(t);n.status="uploading",n.percent=e.percent;const r=ge(n,L);_(n,r,e)},Q=(e,t,n)=>{if(!be(n,L))return;const r=he(n);r.error=e,r.response=t,r.status="error";const o=ge(r,L);_(r,o)},Z=e=>{let t;Promise.resolve("function"==typeof i?i(e):i).then((n=>{var r;if(!1===n)return;const o=function(e,t){const n=void 0!==e.uid?"uid":"name",r=t.filter((t=>t[n]!==e[n]));return r.length===t.length?null:r}(e,L);o&&(t=Object.assign(Object.assign({},e),{status:"removed"}),null==L||L.forEach((e=>{const n=void 0!==t.uid?"uid":"name";e[n]!==t[n]||Object.isFrozen(e)||(e.status="removed")})),null===(r=M.current)||void 0===r||r.abort(t),_(t,o))}))},ee=e=>{z(e.type),"drop"===e.type&&(null==d||d(e))};f.useImperativeHandle(t,(()=>({onBatchStart:K,onSuccess:J,onProgress:Y,onError:Q,fileList:L,upload:M.current,nativeElement:X.current})));const{getPrefixCls:te,direction:ne,upload:re}=f.useContext(D),oe=te("upload",y),ie=Object.assign(Object.assign({onBatchStart:K,onError:Q,onProgress:Y,onSuccess:J},e),{data:O,multiple:I,action:R,accept:P,supportServerRender:N,prefixCls:oe,disabled:A,beforeUpload:(t,n)=>Se(void 0,0,void 0,(function*(){const{beforeUpload:r,transformFile:o}=e;let i=t;if(r){const e=yield r(t,n);if(!1===e)return!1;if(delete t[Ce],e===Ce)return Object.defineProperty(t,Ce,{value:!0,configurable:!0}),!1;"object"==typeof e&&e&&(i=e)}return o&&(i=yield o(i)),i})),onChange:void 0,hasControlInside:j});delete ie.className,delete ie.style,k&&!A||delete ie.id;const le=`${oe}-wrapper`,[se,ce,ue]=fe(oe,le),[de]=W("Upload",G.Upload),{showRemoveIcon:pe,showPreviewIcon:me,showDownloadIcon:ve,removeIcon:we,previewIcon:ye,downloadIcon:$e,extra:xe}="boolean"==typeof a?{}:a,ke=void 0===pe?!A:pe,Oe=(e,t)=>a?f.createElement(Ee,{prefixCls:oe,listType:l,items:L,previewFile:m,onPreview:s,onDownload:c,onRemove:Z,showRemoveIcon:ke,showPreviewIcon:me,showDownloadIcon:ve,removeIcon:we,previewIcon:ye,downloadIcon:$e,iconRender:b,extra:xe,locale:Object.assign(Object.assign({},de),g),isImageUrl:v,progress:w,appendAction:e,appendActionVisible:t,itemRender:S,disabled:A}):e,Ie=p(le,$,F,ce,ue,null==re?void 0:re.className,{[`${oe}-rtl`]:"rtl"===ne,[`${oe}-picture-card-wrapper`]:"picture-card"===l,[`${oe}-picture-circle-wrapper`]:"picture-circle"===l}),je=Object.assign(Object.assign({},null==re?void 0:re.style),E);if("drag"===x){const e=p(ce,oe,`${oe}-drag`,{[`${oe}-drag-uploading`]:L.some((e=>"uploading"===e.status)),[`${oe}-drag-hover`]:"dragover"===q,[`${oe}-disabled`]:A,[`${oe}-rtl`]:"rtl"===ne});return se(f.createElement("span",{className:Ie,ref:X},f.createElement("div",{className:e,style:je,onDrop:ee,onDragOver:ee,onDragLeave:ee},f.createElement(ae,Object.assign({},ie,{ref:M,className:`${oe}-btn`}),f.createElement("div",{className:`${oe}-drag-container`},k))),Oe()))}const Re=p(oe,`${oe}-select`,{[`${oe}-disabled`]:A,[`${oe}-hidden`]:!k}),De=f.createElement("div",{className:Re},f.createElement(ae,Object.assign({},ie,{ref:M})));return se("picture-card"===l||"picture-circle"===l?f.createElement("span",{className:Ie,ref:X},Oe(De,!!k)):f.createElement("span",{className:Ie,ref:X},De,Oe()))},Ie=f.forwardRef(Oe);const je=f.forwardRef(((e,t)=>{var{style:n,height:r,hasControlInside:o=!1}=e,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["style","height","hasControlInside"]);return f.createElement(Ie,Object.assign({ref:t,hasControlInside:o},i,{type:"drag",style:Object.assign(Object.assign({},n),{height:r})}))})),Re=Ie;Re.Dragger=je,Re.LIST_IGNORE=Ce;export{Re as U};
