import{a as e}from"./index-BOSj9b5K.js";import{r as a,e as t,k as i,m as r,j as s,F as d,M as l,b as n,R as o,C as m,I as c,S as Y,L as h}from"./index-CiAhniVm.js";import{g as p,u}from"./index-CeVyQ8_h.js";import{d as f}from"./dayjs.min-x_ORfqZN.js";import{D as _}from"./index-D_cDM7fs.js";import"./useIcons-6XAMJw6F.js";const M=a.forwardRef((({onConfirm:M},D)=>{const[b]=t.useForm(),[x,y]=a.useState(!1),[S,C]=a.useState({});a.useImperativeHandle(D,(()=>({async showEditPassPortFormModal(e){const{data:a,msg:t,code:s}=await p(e);s===i.SUCCESS?(C(a),b.setFieldsValue({...a,birth_date:a.birth_date?f(a.birth_date,"YYYY-MM-DD"):null,issue_date:a.issue_date?f(a.issue_date,"YYYY-MM-DD"):null,expiration_date:a.expiration_date?f(a.expiration_date,"YYYY-MM-DD"):null}),y(!0)):r.error(t)}})));const w=()=>{S.id>0?C({}):C({id:0}),setTimeout((()=>b.resetFields()),100)};return s(d,{children:s(l,{title:"修改信息",width:1200,open:x,onClose:()=>{w(),y(!1)},bodyStyle:{padding:"10px"},footer:n(Y,{children:[s(h,{onClick:e=>{w(),y(!1),e()},children:"取消"}),s(h,{type:"primary",onClick:a=>(a=>{b.validateFields().then((async t=>{var s,d,l;try{const a={...t,birth_date:null==(s=t.birth_date)?void 0:s.format("YYYY-MM-DD"),issue_date:null==(d=t.issue_date)?void 0:d.format("YYYY-MM-DD"),expiration_date:null==(l=t.expiration_date)?void 0:l.format("YYYY-MM-DD")};if(S.id<=0){const{msg:t,code:s}=await e(a);if(s!==i.SUCCESS)return void r.error(t);r.success(t)}else{const{msg:e,code:t}=await u(S.id,a);if(t!==i.SUCCESS)return void r.error(e);r.success("更新成功")}w(),y(!1),M()}finally{a()}})).catch((e=>{r.error("表单校验失败"),a()}))})(a),children:"确定"})]}),children:S.id>0&&s(t,{form:b,layout:"vertical",initialValues:S,children:n(o,{gutter:16,children:[n(m,{span:12,style:{padding:"0 8px"},children:[s(t.Item,{name:"name",label:"中文姓名",children:s(c,{placeholder:"请输入中文姓名"})}),s(t.Item,{name:"first_name",label:"姓",children:s(c,{placeholder:"请输入姓"})}),s(t.Item,{name:"last_name",label:"名",children:s(c,{placeholder:"请输入名"})}),s(t.Item,{name:"passport_number",label:"护照号",children:s(c,{})})]}),n(m,{span:12,style:{padding:"0 8px"},children:[s(t.Item,{name:"birth_date",label:"出生年月",children:s(_,{format:"YYYY-MM-DD",style:{width:"100%"}})}),s(t.Item,{name:"issue_date",label:"签发日期",children:s(_,{format:"YYYY-MM-DD",style:{width:"100%"}})}),s(t.Item,{name:"expiration_date",label:"有效期至",children:s(_,{format:"YYYY-MM-DD",style:{width:"100%"}})})]})]})})})})}));export{M as default};
